<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Daniel Vartanian">
<meta name="dcterms.date" content="2024-09-26">
<title>General linear models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/danielvartan/linear-model"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">General linear models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Vartanian </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-09-26</p>
    </div>
  </div>
  
    
  </div>
  


</header><!-- badges: start --><p><a href="https://www.repostatus.org/#inactive"><img src="https://www.repostatus.org/badges/latest/inactive.svg" class="img-fluid" alt="Project Status: Inactive – The project has reached a stable, usable state but is no longer being actively developed; support/maintenance will be provided as time allows."></a> <a href="https://choosealicense.com/licenses/mit/"><img src="https://img.shields.io/badge/license-MIT-green.png" class="img-fluid" alt="License: MIT"></a> <!-- badges: end --></p>
<section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This document focuses on demonstrating <a href="https://en.wikipedia.org/wiki/General_linear_model">general linear models</a>, with a particular emphasis on multiple regression. The <a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html"><code>penguins</code></a> dataset from the <a href="https://github.com/allisonhorst/palmerpenguins/"><code>palmerpenguins</code></a> package in R, containing measurements of penguin species inhabiting the <a href="https://en.wikipedia.org/wiki/Palmer_Archipelago">Palmer Archipelago</a>, is used. The dataset was originally introduced by <span class="citation" data-cites="gorman2014">Gorman et al. (<a href="#ref-gorman2014" role="doc-biblioref">2014</a>)</span>.</p>
<div id="fig-penguins-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguins-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/palmer_penguins.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Artwork by <a href="https://allisonhorst.com/">Allison Horst</a>.
</figcaption></figure>
</div>
</section><section id="question" class="level2"><h2 class="anchored" data-anchor-id="question">Question</h2>
<p><strong>Can Bill length and Bill depth predict Flipper length?</strong></p>
<p>The goal is to test whether the variables <code>bill_length_mm</code> and <code>bill_depth_mm</code> are good predictors of <code>flipper_length_mm</code>. The definitions of these variables are provided below:</p>
<ul>
<li>
<code>bill_length_mm</code>: numerical value representing bill length in millimeters.</li>
<li>
<code>bill_depth_mm</code>: numerical value representing bill depth in millimeters.</li>
<li>
<code>flipper_length_mm</code>: integer value representing flipper length in millimeters.</li>
</ul>
<div id="fig-penguins-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-penguins-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/culmen_depth.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Artwork by <a href="https://allisonhorst.com/">Allison Horst</a>.
</figcaption></figure>
</div>
</section><section id="a-brief-look-on-general-linear-models" class="level2"><h2 class="anchored" data-anchor-id="a-brief-look-on-general-linear-models">A brief look on general linear models</h2>
<blockquote class="blockquote">
<p>See <span class="citation" data-cites="degroot2012">DeGroot &amp; Schervish (<a href="#ref-degroot2012" role="doc-biblioref">2012, pp. 699–707</a>, pp.&nbsp;736-754)</span> and <span class="citation" data-cites="hair2019">Hair (<a href="#ref-hair2019" role="doc-biblioref">2019, pp. 259–370</a>)</span> to learn more.</p>
</blockquote>
<p>“[…] A problem of this type is called a problem of multiple linear regression because we are considering the regression of <span class="math inline">\(Y\)</span> on <span class="math inline">\(k\)</span> variables <span class="math inline">\(X_{1}, \dots, X_{k}\)</span>, rather than on just a single variable <span class="math inline">\(X\)</span>, and we are assuming also that this regression is a linear function of the parameters <span class="math inline">\(\beta_{0}, \dots, \beta_{k}\)</span>. In a problem of multiple linear regressions, we obtain <span class="math inline">\(n\)</span> vectors of observations (<span class="math inline">\(x_{i1}. \dots, x_{ik}, Y_{i}\)</span>), for <span class="math inline">\(i = 1, \dots, n\)</span>. Here <span class="math inline">\(x_{ij}\)</span> is the observed value of the variable <span class="math inline">\(X_{j}\)</span> for the <span class="math inline">\(i\)</span>th observation. The <span class="math inline">\(E(Y)\)</span> is given by the relation</p>
<p><span class="math display">\[
E(Y_{i}) = \beta_{0} + \beta_{1} x_{i1} + \dots + \beta_{k} x_{ik}
\]</span></p>
<p><span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 738</a>)</span></p>
<section id="definitions" class="level3"><h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<dl>
<dt>Residuals/Fitted Values</dt>
<dd>
For <span class="math inline">\(i = 1, \dots, n\)</span>, the observed values of <span class="math inline">\(\hat{y} = \hat{\beta}_{0} + \hat{\beta}_{1} x_{i}\)</span> are called <em>fitted values</em>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the observed values of <span class="math inline">\(e_{i} = y_{i} - \hat{y}_{i}\)</span> are called <em>residuals</em> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 717</a>)</span>.
</dd>
</dl>
<p>“[…] regression problems in which the observations <span class="math inline">\(Y_{i}, \dots, Y_{n}\)</span> […] we shall assume that each observation <span class="math inline">\(Y_{i}\)</span> has a normal distribution, that the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> are independent, and that the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> have the same variance <span class="math inline">\(\sigma^{2}\)</span>. Instead of a single predictor being associated with each <span class="math inline">\(Y_{i}\)</span>, we assume that a <span class="math inline">\(p\)</span>-dimensional vector <span class="math inline">\(z_{i} = (z_{i0}, \dots, z_{ip - 1})\)</span> is associated with each <span class="math inline">\(Y_{i}\)</span>” <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 736</a>)</span>.</p>
<dl>
<dt>General Linear Model</dt>
<dd>
The statistical model in which the observations <span class="math inline">\(Y_{1}, \dots, Y_{n}\)</span> satisfy the following assumptions <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 738</a>)</span>.
</dd>
</dl></section><section id="assumptions" class="level3"><h3 class="anchored" data-anchor-id="assumptions">Assumptions</h3>
<dl>
<dt>Assumption 1</dt>
<dd>
<strong>Predictor is known</strong>. Either the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> are known ahead of time, or they are the observed values of random vectors <span class="math inline">\(Z_{1}, \dots , Z_{n}\)</span> on whose values we condition before computing the joint distribution of (<span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span>) <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 736</a>)</span>.
</dd>
<dt>Assumption 2</dt>
<dd>
<strong>Normality</strong>. For <span class="math inline">\(i = 1, \dots, n\)</span>, the conditional distribution of <span class="math inline">\(Y_{i}\)</span> given the vectors <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is a normal distribution <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Normality of the error term distribution <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<dl>
<dt>Assumption 3</dt>
<dd>
<strong>Linear mean</strong>. There is a vector of parameters <span class="math inline">\(\beta = (\beta_{0}, \dots, \beta_{p - 1})\)</span> such that the conditional mean of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> has the form
</dd>
</dl>
<p><span class="math display">\[
z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, n\)</span> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.</p>
<p>(Linearity of the phenomenon measured <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<dl>
<dt>Assumption 4</dt>
<dd>
<strong>Common variance</strong>. There is as parameter <span class="math inline">\(\sigma^{2}\)</span> such the conditional variance of <span class="math inline">\(Y_{i}\)</span> given the values <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> is <span class="math inline">\(\sigma^{2}\)</span> for <span class="math inline">\(i = 1, \dots\, n\)</span>.
</dd>
</dl>
<p>(Constant variance of the error terms <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
<dl>
<dt>Assumption 5</dt>
<dd>
<strong>Independence</strong>. The random variables <span class="math inline">\(Y_{1}, \dots , Y_{n}\)</span> are independent given the observed <span class="math inline">\(z_{1}, \dots , z_{n}\)</span> <span class="citation" data-cites="degroot2012">(<a href="#ref-degroot2012" role="doc-biblioref">DeGroot &amp; Schervish, 2012, p. 737</a>)</span>.
</dd>
</dl>
<p>(Independence of the error terms <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 287</a>)</span>)</p>
</section></section><section id="setting-up-the-environment" class="level2"><h2 class="anchored" data-anchor-id="setting-up-the-environment">Setting up the environment</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mllg.github.io/checkmate/">checkmate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://geobosh.github.io/fBasicsDoc/">fBasics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://olsrr.rsquaredacademy.com/">olsrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip">parsnip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes">recipes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://danielvartan.github.io/rutils/">rutils</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflows">workflows</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_outlier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>, </span>
<span>    <span class="va">method</span> <span class="op">=</span> <span class="st">"iqr"</span>, </span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    <span class="va">sd_mult</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">method</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iqr"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">sd_mult</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"iqr"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">iqr</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">iqr_mult</span> <span class="op">*</span> <span class="va">iqr</span><span class="op">)</span></span>
<span>    <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">iqr_mult</span> <span class="op">*</span> <span class="va">iqr</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"sd"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">sd_mult</span> <span class="op">*</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">sd_mult</span> <span class="op">*</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="va">min</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="va">max</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">remove_outliers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>, </span>
<span>    <span class="va">method</span> <span class="op">=</span> <span class="st">"iqr"</span>, </span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    <span class="va">sd_mult</span> <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">method</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iqr"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">sd_mult</span>, lower <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">test_outlier</span><span class="op">(</span></span>
<span>      method <span class="op">=</span> <span class="va">method</span>, </span>
<span>      iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span>, </span>
<span>      sd_mult <span class="op">=</span> <span class="va">sd_mult</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">`!`</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">list_as_tibble</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkList.html">assert_list</a></span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">list</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="va">as.character</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stats_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">name</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">remove_outliers</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    <span class="va">as_list</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">as_list</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">remove_outliers</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"iqr"</span>, iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    n_rm_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    n_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    var <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    min <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    q_1 <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    q_3 <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">clear_names</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    iqr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    skewness <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span>,</span>
<span>    kurtosis <span class="op">=</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="va">out</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, after <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">as_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">|&gt;</span> <span class="fu">list_as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_qq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="st">"Theoretical quantiles (Std. normal)"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Sample quantiles"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_hist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">x</span>,</span>
<span>    <span class="va">name</span> <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>    <span class="va">bins</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>    <span class="va">stat</span> <span class="op">=</span> <span class="st">"density"</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">density_line</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">bins</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">stat</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"count"</span>, <span class="st">"density"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">y_lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">stat</span> <span class="op">==</span> <span class="st">"count"</span>, <span class="st">"Frequency"</span>, <span class="st">"Density"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/name.html">as.symbol</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      bins <span class="op">=</span> <span class="fl">30</span>, </span>
<span>      color <span class="op">=</span> <span class="st">"white"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">y_lab</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">stat</span> <span class="op">==</span> <span class="st">"density"</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">plot</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_ggally</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>    <span class="va">mapping</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="va">axis_labels</span> <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    <span class="va">na_rm</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkTibble.html">assert_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCharacter.html">assert_character</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkSubset.html">assert_subset</a></span><span class="op">(</span><span class="va">cols</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkClass.html">assert_class</a></span><span class="op">(</span><span class="va">mapping</span>, <span class="st">"uneval"</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkChoice.html">assert_choice</a></span><span class="op">(</span><span class="va">axis_labels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"show"</span>, <span class="st">"internal"</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">data</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="fu">hms</span><span class="fu">::</span><span class="va"><a href="https://hms.tidyverse.org/reference/hms.html">is_hms</a></span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span> <span class="fu">midday_trigger</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>        .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span></span>
<span>          <span class="op">~</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">is.factor</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">na_rm</span><span class="op">)</span><span class="op">)</span> <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">mapping</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">out</span><span class="op">|&gt;</span></span>
<span>      <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>        lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="st">"smooth"</span><span class="op">)</span>,</span>
<span>        axisLabels <span class="op">=</span> <span class="va">axis_labels</span></span>
<span>      <span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">out</span><span class="op">|&gt;</span></span>
<span>      <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span></span>
<span>        mapping <span class="op">=</span> <span class="va">mapping</span>,</span>
<span>        axisLabels <span class="op">=</span> <span class="va">axis_labels</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_color_viridis</a></span><span class="op">(</span></span>
<span>        begin <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>        end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>        discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        option <span class="op">=</span> <span class="st">"viridis"</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html">scale_fill_viridis</a></span><span class="op">(</span></span>
<span>        begin <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>        end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>        discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        option <span class="op">=</span> <span class="st">"viridis"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">plot</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">text_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">test_normality</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,</span>
<span>                           <span class="va">name</span> <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                           <span class="va">remove_outliers</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           <span class="va">iqr_mult</span> <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>                           <span class="va">log_transform</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                           <span class="va">density_line</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           <span class="va">text_size</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                           <span class="va">print</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkString.html">assert_string</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">iqr_mult</span>, lower <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">log_transform</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">density_line</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">text_size</span>, null.ok <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">n_rm_na</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">remove_outliers</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">remove_outliers</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"iqr"</span>, iqr_mult <span class="op">=</span> <span class="va">iqr_mult</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">log_transform</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">drop_inf</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">ad.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">cvm</span> <span class="op">&lt;-</span></span>
<span>      <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/cvm.test.html">cvm.test</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">ad</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">cmv</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">bonett</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">moments</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/moments/man/bonett.test.html">bonett.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># See also `Rita::DPTest()` (just for Omnibus (K) tests).</span></span>
<span>  <span class="va">dagostino</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">fBasics</span><span class="fu">::</span><span class="fu"><a href="https://geobosh.github.io/fBasicsDoc/reference/test-normalityTests.html">dagoTest</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">jarque_bera</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">drop_na</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tseries</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/jarque.bera.test.html">jarque.bera.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">lillie_ks</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">lillie_ks</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">pearson</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/pearson.test.html">pearson.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">5</span> <span class="op">&amp;&amp;</span> <span class="va">n_rm_na</span> <span class="op">&lt;=</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sf</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">nortest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/sf.test.html">sf.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">sf</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">n_rm_na</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">&amp;&amp;</span> <span class="va">n_rm_na</span> <span class="op">&lt;=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">shapiro</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">shapiro</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">qq_plot</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">plot_qq</span><span class="op">(</span>text_size <span class="op">=</span> <span class="va">text_size</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">hist_plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">plot_hist</span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      text_size <span class="op">=</span> <span class="va">text_size</span>,</span>
<span>      density_line <span class="op">=</span> <span class="va">density_line</span>,</span>
<span>      print <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>  <span class="va">grid_plot</span> <span class="op">&lt;-</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hist_plot</span>, <span class="va">qq_plot</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    stats <span class="op">=</span> <span class="fu">stats_sum</span><span class="op">(</span></span>
<span>      <span class="va">x</span>,</span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      na_rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      remove_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      as_list <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="va">name</span>,</span>
<span>      remove_outliers <span class="op">=</span> <span class="va">remove_outliers</span>,</span>
<span>      log_transform <span class="op">=</span> <span class="va">log_transform</span>,</span>
<span>      density_line <span class="op">=</span> <span class="va">density_line</span></span>
<span>    <span class="op">)</span>,</span>
<span></span>
<span>    ad <span class="op">=</span> <span class="va">ad</span>,</span>
<span>    bonett <span class="op">=</span> <span class="va">bonett</span>,</span>
<span>    cvm <span class="op">=</span> <span class="va">cvm</span>,</span>
<span>    dagostino <span class="op">=</span> <span class="va">dagostino</span>,</span>
<span>    jarque_bera <span class="op">=</span> <span class="va">jarque_bera</span>,</span>
<span>    lillie_ks <span class="op">=</span> <span class="va">lillie_ks</span>,</span>
<span>    pearson <span class="op">=</span> <span class="va">pearson</span>,</span>
<span>    sf <span class="op">=</span> <span class="va">sf</span>,</span>
<span>    shapiro <span class="op">=</span> <span class="va">shapiro</span>,</span>
<span></span>
<span>    hist_plot <span class="op">=</span> <span class="va">hist_plot</span>,</span>
<span>    qq_plot <span class="op">=</span> <span class="va">qq_plot</span>,</span>
<span>    grid_plot <span class="op">=</span> <span class="va">grid_plot</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">grid_plot</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">normality_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">round</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">digits</span> <span class="op">=</span> <span class="fl">5</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumeric.html">assert_numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFlag.html">assert_flag</a></span><span class="op">(</span><span class="va">round</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkNumber.html">assert_number</a></span><span class="op">(</span><span class="va">digits</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu">test_normality</span><span class="op">(</span><span class="va">x</span>, print <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Anderson-Darling"</span>,</span>
<span>      <span class="st">"Bonett-Seier"</span>,</span>
<span>      <span class="st">"Cramer-von Mises"</span>,</span>
<span>      <span class="st">"D'Agostino Omnibus Test"</span>,</span>
<span>      <span class="st">"D'Agostino Skewness Test"</span>,</span>
<span>      <span class="st">"D'Agostino Kurtosis Test"</span>,</span>
<span>      <span class="st">"Jarque–Bera"</span>,</span>
<span>      <span class="st">"Lilliefors (K-S)"</span>,</span>
<span>      <span class="st">"Pearson chi-square"</span>,</span>
<span>      <span class="st">"Shapiro-Francia"</span>,</span>
<span>      <span class="st">"Shapiro-Wilk"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    statistic_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">ad</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">cvm</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">lillie_ks</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">pearson</span><span class="op">$</span><span class="va">statistic</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    statistic_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">statistic</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">parameter</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">ad</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">bonett</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">cvm</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">dagostino</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">jarque_bera</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">lillie_ks</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">stats</span><span class="op">$</span><span class="va">pearson</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">shapiro</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">stats</span><span class="op">$</span><span class="va">sf</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">p_value</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html">isTRUE</a></span><span class="op">(</span><span class="va">round</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>          .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>,</span>
<span>          .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="va">digits</span><span class="op">)</span></span>
<span>        <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="preparing-the-data" class="level2"><h2 class="anchored" data-anchor-id="preparing-the-data">Preparing the data</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html">penguins</a></span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">bill_depth_mm</span>, <span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu">test_outlier</span><span class="op">(</span><span class="va">.x</span>, , iqr_mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">.x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["bill_length_mm"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["bill_depth_mm"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["flipper_length_mm"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"39.1","2":"18.7","3":"181"},{"1":"39.5","2":"17.4","3":"186"},{"1":"40.3","2":"18.0","3":"195"},{"1":"36.7","2":"19.3","3":"193"},{"1":"39.3","2":"20.6","3":"190"},{"1":"38.9","2":"17.8","3":"181"},{"1":"39.2","2":"19.6","3":"195"},{"1":"34.1","2":"18.1","3":"193"},{"1":"42.0","2":"20.2","3":"190"},{"1":"37.8","2":"17.1","3":"186"},{"1":"37.8","2":"17.3","3":"180"},{"1":"41.1","2":"17.6","3":"182"},{"1":"38.6","2":"21.2","3":"191"},{"1":"34.6","2":"21.1","3":"198"},{"1":"36.6","2":"17.8","3":"185"},{"1":"38.7","2":"19.0","3":"195"},{"1":"42.5","2":"20.7","3":"197"},{"1":"34.4","2":"18.4","3":"184"},{"1":"46.0","2":"21.5","3":"194"},{"1":"37.8","2":"18.3","3":"174"},{"1":"37.7","2":"18.7","3":"180"},{"1":"35.9","2":"19.2","3":"189"},{"1":"38.2","2":"18.1","3":"185"},{"1":"38.8","2":"17.2","3":"180"},{"1":"35.3","2":"18.9","3":"187"},{"1":"40.6","2":"18.6","3":"183"},{"1":"40.5","2":"17.9","3":"187"},{"1":"37.9","2":"18.6","3":"172"},{"1":"40.5","2":"18.9","3":"180"},{"1":"39.5","2":"16.7","3":"178"},{"1":"37.2","2":"18.1","3":"178"},{"1":"39.5","2":"17.8","3":"188"},{"1":"40.9","2":"18.9","3":"184"},{"1":"36.4","2":"17.0","3":"195"},{"1":"39.2","2":"21.1","3":"196"},{"1":"38.8","2":"20.0","3":"190"},{"1":"42.2","2":"18.5","3":"180"},{"1":"37.6","2":"19.3","3":"181"},{"1":"39.8","2":"19.1","3":"184"},{"1":"36.5","2":"18.0","3":"182"},{"1":"40.8","2":"18.4","3":"195"},{"1":"36.0","2":"18.5","3":"186"},{"1":"44.1","2":"19.7","3":"196"},{"1":"37.0","2":"16.9","3":"185"},{"1":"39.6","2":"18.8","3":"190"},{"1":"41.1","2":"19.0","3":"182"},{"1":"37.5","2":"18.9","3":"179"},{"1":"36.0","2":"17.9","3":"190"},{"1":"42.3","2":"21.2","3":"191"},{"1":"39.6","2":"17.7","3":"186"},{"1":"40.1","2":"18.9","3":"188"},{"1":"35.0","2":"17.9","3":"190"},{"1":"42.0","2":"19.5","3":"200"},{"1":"34.5","2":"18.1","3":"187"},{"1":"41.4","2":"18.6","3":"191"},{"1":"39.0","2":"17.5","3":"186"},{"1":"40.6","2":"18.8","3":"193"},{"1":"36.5","2":"16.6","3":"181"},{"1":"37.6","2":"19.1","3":"194"},{"1":"35.7","2":"16.9","3":"185"},{"1":"41.3","2":"21.1","3":"195"},{"1":"37.6","2":"17.0","3":"185"},{"1":"41.1","2":"18.2","3":"192"},{"1":"36.4","2":"17.1","3":"184"},{"1":"41.6","2":"18.0","3":"192"},{"1":"35.5","2":"16.2","3":"195"},{"1":"41.1","2":"19.1","3":"188"},{"1":"35.9","2":"16.6","3":"190"},{"1":"41.8","2":"19.4","3":"198"},{"1":"33.5","2":"19.0","3":"190"},{"1":"39.7","2":"18.4","3":"190"},{"1":"39.6","2":"17.2","3":"196"},{"1":"45.8","2":"18.9","3":"197"},{"1":"35.5","2":"17.5","3":"190"},{"1":"42.8","2":"18.5","3":"195"},{"1":"40.9","2":"16.8","3":"191"},{"1":"37.2","2":"19.4","3":"184"},{"1":"36.2","2":"16.1","3":"187"},{"1":"42.1","2":"19.1","3":"195"},{"1":"34.6","2":"17.2","3":"189"},{"1":"42.9","2":"17.6","3":"196"},{"1":"36.7","2":"18.8","3":"187"},{"1":"35.1","2":"19.4","3":"193"},{"1":"37.3","2":"17.8","3":"191"},{"1":"41.3","2":"20.3","3":"194"},{"1":"36.3","2":"19.5","3":"190"},{"1":"36.9","2":"18.6","3":"189"},{"1":"38.3","2":"19.2","3":"189"},{"1":"38.9","2":"18.8","3":"190"},{"1":"35.7","2":"18.0","3":"202"},{"1":"41.1","2":"18.1","3":"205"},{"1":"34.0","2":"17.1","3":"185"},{"1":"39.6","2":"18.1","3":"186"},{"1":"36.2","2":"17.3","3":"187"},{"1":"40.8","2":"18.9","3":"208"},{"1":"38.1","2":"18.6","3":"190"},{"1":"40.3","2":"18.5","3":"196"},{"1":"33.1","2":"16.1","3":"178"},{"1":"43.2","2":"18.5","3":"192"},{"1":"35.0","2":"17.9","3":"192"},{"1":"41.0","2":"20.0","3":"203"},{"1":"37.7","2":"16.0","3":"183"},{"1":"37.8","2":"20.0","3":"190"},{"1":"37.9","2":"18.6","3":"193"},{"1":"39.7","2":"18.9","3":"184"},{"1":"38.6","2":"17.2","3":"199"},{"1":"38.2","2":"20.0","3":"190"},{"1":"38.1","2":"17.0","3":"181"},{"1":"43.2","2":"19.0","3":"197"},{"1":"38.1","2":"16.5","3":"198"},{"1":"45.6","2":"20.3","3":"191"},{"1":"39.7","2":"17.7","3":"193"},{"1":"42.2","2":"19.5","3":"197"},{"1":"39.6","2":"20.7","3":"191"},{"1":"42.7","2":"18.3","3":"196"},{"1":"38.6","2":"17.0","3":"188"},{"1":"37.3","2":"20.5","3":"199"},{"1":"35.7","2":"17.0","3":"189"},{"1":"41.1","2":"18.6","3":"189"},{"1":"36.2","2":"17.2","3":"187"},{"1":"37.7","2":"19.8","3":"198"},{"1":"40.2","2":"17.0","3":"176"},{"1":"41.4","2":"18.5","3":"202"},{"1":"35.2","2":"15.9","3":"186"},{"1":"40.6","2":"19.0","3":"199"},{"1":"38.8","2":"17.6","3":"191"},{"1":"41.5","2":"18.3","3":"195"},{"1":"39.0","2":"17.1","3":"191"},{"1":"44.1","2":"18.0","3":"210"},{"1":"38.5","2":"17.9","3":"190"},{"1":"43.1","2":"19.2","3":"197"},{"1":"36.8","2":"18.5","3":"193"},{"1":"37.5","2":"18.5","3":"199"},{"1":"38.1","2":"17.6","3":"187"},{"1":"41.1","2":"17.5","3":"190"},{"1":"35.6","2":"17.5","3":"191"},{"1":"40.2","2":"20.1","3":"200"},{"1":"37.0","2":"16.5","3":"185"},{"1":"39.7","2":"17.9","3":"193"},{"1":"40.2","2":"17.1","3":"193"},{"1":"40.6","2":"17.2","3":"187"},{"1":"32.1","2":"15.5","3":"188"},{"1":"40.7","2":"17.0","3":"190"},{"1":"37.3","2":"16.8","3":"192"},{"1":"39.0","2":"18.7","3":"185"},{"1":"39.2","2":"18.6","3":"190"},{"1":"36.6","2":"18.4","3":"184"},{"1":"36.0","2":"17.8","3":"195"},{"1":"37.8","2":"18.1","3":"193"},{"1":"36.0","2":"17.1","3":"187"},{"1":"41.5","2":"18.5","3":"201"},{"1":"46.1","2":"13.2","3":"211"},{"1":"50.0","2":"16.3","3":"230"},{"1":"48.7","2":"14.1","3":"210"},{"1":"50.0","2":"15.2","3":"218"},{"1":"47.6","2":"14.5","3":"215"},{"1":"46.5","2":"13.5","3":"210"},{"1":"45.4","2":"14.6","3":"211"},{"1":"46.7","2":"15.3","3":"219"},{"1":"43.3","2":"13.4","3":"209"},{"1":"46.8","2":"15.4","3":"215"},{"1":"40.9","2":"13.7","3":"214"},{"1":"49.0","2":"16.1","3":"216"},{"1":"45.5","2":"13.7","3":"214"},{"1":"48.4","2":"14.6","3":"213"},{"1":"45.8","2":"14.6","3":"210"},{"1":"49.3","2":"15.7","3":"217"},{"1":"42.0","2":"13.5","3":"210"},{"1":"49.2","2":"15.2","3":"221"},{"1":"46.2","2":"14.5","3":"209"},{"1":"48.7","2":"15.1","3":"222"},{"1":"50.2","2":"14.3","3":"218"},{"1":"45.1","2":"14.5","3":"215"},{"1":"46.5","2":"14.5","3":"213"},{"1":"46.3","2":"15.8","3":"215"},{"1":"42.9","2":"13.1","3":"215"},{"1":"46.1","2":"15.1","3":"215"},{"1":"44.5","2":"14.3","3":"216"},{"1":"47.8","2":"15.0","3":"215"},{"1":"48.2","2":"14.3","3":"210"},{"1":"50.0","2":"15.3","3":"220"},{"1":"47.3","2":"15.3","3":"222"},{"1":"42.8","2":"14.2","3":"209"},{"1":"45.1","2":"14.5","3":"207"},{"1":"49.1","2":"14.8","3":"220"},{"1":"48.4","2":"16.3","3":"220"},{"1":"42.6","2":"13.7","3":"213"},{"1":"44.4","2":"17.3","3":"219"},{"1":"44.0","2":"13.6","3":"208"},{"1":"48.7","2":"15.7","3":"208"},{"1":"42.7","2":"13.7","3":"208"},{"1":"49.6","2":"16.0","3":"225"},{"1":"45.3","2":"13.7","3":"210"},{"1":"49.6","2":"15.0","3":"216"},{"1":"50.5","2":"15.9","3":"222"},{"1":"43.6","2":"13.9","3":"217"},{"1":"45.5","2":"13.9","3":"210"},{"1":"50.5","2":"15.9","3":"225"},{"1":"44.9","2":"13.3","3":"213"},{"1":"45.2","2":"15.8","3":"215"},{"1":"46.6","2":"14.2","3":"210"},{"1":"48.5","2":"14.1","3":"220"},{"1":"45.1","2":"14.4","3":"210"},{"1":"50.1","2":"15.0","3":"225"},{"1":"46.5","2":"14.4","3":"217"},{"1":"45.0","2":"15.4","3":"220"},{"1":"43.8","2":"13.9","3":"208"},{"1":"45.5","2":"15.0","3":"220"},{"1":"43.2","2":"14.5","3":"208"},{"1":"50.4","2":"15.3","3":"224"},{"1":"45.3","2":"13.8","3":"208"},{"1":"46.2","2":"14.9","3":"221"},{"1":"45.7","2":"13.9","3":"214"},{"1":"54.3","2":"15.7","3":"231"},{"1":"45.8","2":"14.2","3":"219"},{"1":"49.8","2":"16.8","3":"230"},{"1":"46.2","2":"14.4","3":"214"},{"1":"49.5","2":"16.2","3":"229"},{"1":"43.5","2":"14.2","3":"220"},{"1":"50.7","2":"15.0","3":"223"},{"1":"47.7","2":"15.0","3":"216"},{"1":"46.4","2":"15.6","3":"221"},{"1":"48.2","2":"15.6","3":"221"},{"1":"46.5","2":"14.8","3":"217"},{"1":"46.4","2":"15.0","3":"216"},{"1":"48.6","2":"16.0","3":"230"},{"1":"47.5","2":"14.2","3":"209"},{"1":"51.1","2":"16.3","3":"220"},{"1":"45.2","2":"13.8","3":"215"},{"1":"45.2","2":"16.4","3":"223"},{"1":"49.1","2":"14.5","3":"212"},{"1":"52.5","2":"15.6","3":"221"},{"1":"47.4","2":"14.6","3":"212"},{"1":"50.0","2":"15.9","3":"224"},{"1":"44.9","2":"13.8","3":"212"},{"1":"50.8","2":"17.3","3":"228"},{"1":"43.4","2":"14.4","3":"218"},{"1":"51.3","2":"14.2","3":"218"},{"1":"47.5","2":"14.0","3":"212"},{"1":"52.1","2":"17.0","3":"230"},{"1":"47.5","2":"15.0","3":"218"},{"1":"52.2","2":"17.1","3":"228"},{"1":"45.5","2":"14.5","3":"212"},{"1":"49.5","2":"16.1","3":"224"},{"1":"44.5","2":"14.7","3":"214"},{"1":"50.8","2":"15.7","3":"226"},{"1":"49.4","2":"15.8","3":"216"},{"1":"46.9","2":"14.6","3":"222"},{"1":"48.4","2":"14.4","3":"203"},{"1":"51.1","2":"16.5","3":"225"},{"1":"48.5","2":"15.0","3":"219"},{"1":"55.9","2":"17.0","3":"228"},{"1":"47.2","2":"15.5","3":"215"},{"1":"49.1","2":"15.0","3":"228"},{"1":"47.3","2":"13.8","3":"216"},{"1":"46.8","2":"16.1","3":"215"},{"1":"41.7","2":"14.7","3":"210"},{"1":"53.4","2":"15.8","3":"219"},{"1":"43.3","2":"14.0","3":"208"},{"1":"48.1","2":"15.1","3":"209"},{"1":"50.5","2":"15.2","3":"216"},{"1":"49.8","2":"15.9","3":"229"},{"1":"43.5","2":"15.2","3":"213"},{"1":"51.5","2":"16.3","3":"230"},{"1":"46.2","2":"14.1","3":"217"},{"1":"55.1","2":"16.0","3":"230"},{"1":"44.5","2":"15.7","3":"217"},{"1":"48.8","2":"16.2","3":"222"},{"1":"47.2","2":"13.7","3":"214"},{"1":"46.8","2":"14.3","3":"215"},{"1":"50.4","2":"15.7","3":"222"},{"1":"45.2","2":"14.8","3":"212"},{"1":"49.9","2":"16.1","3":"213"},{"1":"46.5","2":"17.9","3":"192"},{"1":"50.0","2":"19.5","3":"196"},{"1":"51.3","2":"19.2","3":"193"},{"1":"45.4","2":"18.7","3":"188"},{"1":"52.7","2":"19.8","3":"197"},{"1":"45.2","2":"17.8","3":"198"},{"1":"46.1","2":"18.2","3":"178"},{"1":"51.3","2":"18.2","3":"197"},{"1":"46.0","2":"18.9","3":"195"},{"1":"51.3","2":"19.9","3":"198"},{"1":"46.6","2":"17.8","3":"193"},{"1":"51.7","2":"20.3","3":"194"},{"1":"47.0","2":"17.3","3":"185"},{"1":"52.0","2":"18.1","3":"201"},{"1":"45.9","2":"17.1","3":"190"},{"1":"50.5","2":"19.6","3":"201"},{"1":"50.3","2":"20.0","3":"197"},{"1":"46.4","2":"18.6","3":"190"},{"1":"49.2","2":"18.2","3":"195"},{"1":"42.4","2":"17.3","3":"181"},{"1":"48.5","2":"17.5","3":"191"},{"1":"43.2","2":"16.6","3":"187"},{"1":"50.6","2":"19.4","3":"193"},{"1":"46.7","2":"17.9","3":"195"},{"1":"52.0","2":"19.0","3":"197"},{"1":"50.5","2":"18.4","3":"200"},{"1":"49.5","2":"19.0","3":"200"},{"1":"46.4","2":"17.8","3":"191"},{"1":"52.8","2":"20.0","3":"205"},{"1":"40.9","2":"16.6","3":"187"},{"1":"54.2","2":"20.8","3":"201"},{"1":"42.5","2":"16.7","3":"187"},{"1":"51.0","2":"18.8","3":"203"},{"1":"49.7","2":"18.6","3":"195"},{"1":"47.5","2":"16.8","3":"199"},{"1":"47.6","2":"18.3","3":"195"},{"1":"52.0","2":"20.7","3":"210"},{"1":"46.9","2":"16.6","3":"192"},{"1":"53.5","2":"19.9","3":"205"},{"1":"49.0","2":"19.5","3":"210"},{"1":"46.2","2":"17.5","3":"187"},{"1":"50.9","2":"19.1","3":"196"},{"1":"45.5","2":"17.0","3":"196"},{"1":"50.9","2":"17.9","3":"196"},{"1":"50.8","2":"18.5","3":"201"},{"1":"50.1","2":"17.9","3":"190"},{"1":"49.0","2":"19.6","3":"212"},{"1":"51.5","2":"18.7","3":"187"},{"1":"49.8","2":"17.3","3":"198"},{"1":"48.1","2":"16.4","3":"199"},{"1":"51.4","2":"19.0","3":"201"},{"1":"45.7","2":"17.3","3":"193"},{"1":"50.7","2":"19.7","3":"203"},{"1":"42.5","2":"17.3","3":"187"},{"1":"52.2","2":"18.8","3":"197"},{"1":"45.2","2":"16.6","3":"191"},{"1":"49.3","2":"19.9","3":"203"},{"1":"50.2","2":"18.8","3":"202"},{"1":"45.6","2":"19.4","3":"194"},{"1":"51.9","2":"19.5","3":"206"},{"1":"46.8","2":"16.5","3":"189"},{"1":"45.7","2":"17.0","3":"195"},{"1":"55.8","2":"19.8","3":"207"},{"1":"43.5","2":"18.1","3":"202"},{"1":"49.6","2":"18.2","3":"193"},{"1":"50.8","2":"19.0","3":"210"},{"1":"50.2","2":"18.7","3":"198"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="checking-variable-distributions" class="level2"><h2 class="anchored" data-anchor-id="checking-variable-distributions">Checking variable distributions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><code>bill_length_mm</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>bill_depth_mm</code></a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>flipper_length_mm</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"bill_length_mm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-bill_length_mm-stats" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bill_length_mm-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Statistics about the <code>bill_length_mm</code> variable.
</figcaption><div aria-describedby="tbl-bill_length_mm-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"bill_length_mm"},{"1":"n","2":"340"},{"1":"n_rm_na","2":"340"},{"1":"n_na","2":"0"},{"1":"mean","2":"43.8344117647059"},{"1":"var","2":"28.665508502516"},{"1":"sd","2":"5.35401797741809"},{"1":"min","2":"32.1"},{"1":"q_1","2":"39.2"},{"1":"median","2":"44.25"},{"1":"q_3","2":"48.425"},{"1":"max","2":"55.9"},{"1":"iqr","2":"9.22499999999999"},{"1":"skewness","2":"-0.0223636078174643"},{"1":"kurtosis","2":"1.9429077447432"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"bill_length_mm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-bill_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bill_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Histogram of the <code>bill_length_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"bill_depth_mm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-bill_depth_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Statistics about the <code>bill_depth_mm</code> variable.
</figcaption><div aria-describedby="tbl-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"bill_depth_mm"},{"1":"n","2":"340"},{"1":"n_rm_na","2":"340"},{"1":"n_na","2":"0"},{"1":"mean","2":"17.1497058823529"},{"1":"var","2":"3.92150433801839"},{"1":"sd","2":"1.98027885360077"},{"1":"min","2":"13.1"},{"1":"q_1","2":"15.575"},{"1":"median","2":"17.3"},{"1":"q_3","2":"18.7"},{"1":"max","2":"21.5"},{"1":"iqr","2":"3.125"},{"1":"skewness","2":"-0.140369711963729"},{"1":"kurtosis","2":"2.07756586034564"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"bill_depth_mm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-bill_depth_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bill_depth_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Histogram of the <code>bill_depth_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"flipper_length_mm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-flipper_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Statistics about the <code>flipper_length_mm</code> variable.
</figcaption><div aria-describedby="tbl-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"flipper_length_mm"},{"1":"n","2":"340"},{"1":"n_rm_na","2":"340"},{"1":"n_na","2":"0"},{"1":"mean","2":"200.888235294118"},{"1":"var","2":"195.232309560993"},{"1":"sd","2":"13.972555584466"},{"1":"min","2":"172"},{"1":"q_1","2":"190"},{"1":"median","2":"197"},{"1":"q_3","2":"213"},{"1":"max","2":"231"},{"1":"iqr","2":"23"},{"1":"skewness","2":"0.340575181210794"},{"1":"kurtosis","2":"2.0114994949746"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">test_normality</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"flipper_length_mm"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-flipper_length_mm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-flipper_length_mm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Histogram of the <code>flipper_length_mm</code> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.
</figcaption></figure>
</div>
</div>
</div>
</div>
</section><section id="checking-correlations" class="level2"><h2 class="anchored" data-anchor-id="checking-correlations">Checking correlations</h2>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">plot_ggally</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rutils</span><span class="fu">:::</span><span class="fu">shush</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-correlation-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlation-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Correlation matrix of data variables.
</figcaption></figure>
</div>
</section><section id="fitting-the-model" class="level2"><h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h2>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">recipe</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html">recipe</a></span><span class="op">(</span></span>
<span>    <span class="va">flipper_length_mm</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">+</span> <span class="va">bill_depth_mm</span>, </span>
<span>    data <span class="op">=</span> <span class="va">data</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">workflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/workflow.html">workflow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_recipe.html">add_recipe</a></span><span class="op">(</span><span class="va">recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu"><a href="https://workflows.tidymodels.org/reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">workflow</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/fit.html">fit</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span></span>
<span><span class="co">#&gt; ══ Workflow [trained] ═══════════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; Preprocessor: Recipe</span></span>
<span><span class="co">#&gt; Model: linear_reg()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Preprocessor ─────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; 0 Recipe Steps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Model ────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;    (Intercept)  bill_length_mm   bill_depth_mm  </span></span>
<span><span class="co">#&gt;        191.365           1.464          -3.187</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"191.365280","3":"6.25580440","4":"30.59004","5":"0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002887638"},{"1":"bill_length_mm","2":"1.463966","3":"0.08774239","4":"16.68482","5":"0.000000000000000000000000000000000000000000000553512247053635681771910359572075321921147406101226806640625"},{"1":"bill_depth_mm","2":"-3.186592","3":"0.23722637","4":"-13.43271","5":"0.000000000000000000000000000000003053309761220643703174409955281021211703773587942123413085937500000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred"],"name":[1],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bill_length_mm"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bill_depth_mm"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["flipper_length_mm"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"189.0171","2":"-8.017063125","3":"39.1","4":"18.7","5":"181"},{"1":"193.7452","2":"-7.745219571","3":"39.5","4":"17.4","5":"186"},{"1":"193.0044","2":"1.995563278","3":"40.3","4":"18.0","5":"195"},{"1":"183.5916","2":"9.408410136","3":"36.7","4":"19.3","5":"193"},{"1":"183.2553","2":"6.744669321","3":"39.3","4":"20.6","5":"190"},{"1":"191.5922","2":"-10.592203151","3":"38.9","4":"17.8","5":"181"},{"1":"186.2955","2":"8.704473477","3":"39.2","4":"19.6","5":"195"},{"1":"183.6092","2":"9.390810192","3":"34.1","4":"18.1","5":"193"},{"1":"188.4827","2":"1.517324819","3":"42.0","4":"20.2","5":"190"},{"1":"192.2125","2":"-6.212455515","3":"37.8","4":"17.1","5":"186"},{"1":"191.5751","2":"-11.575137032","3":"37.8","4":"17.3","5":"180"},{"1":"195.4502","2":"-13.450246293","3":"41.1","4":"17.6","5":"182"},{"1":"180.3186","2":"10.681400800","3":"38.6","4":"21.2","5":"191"},{"1":"174.7814","2":"23.218604573","3":"34.6","4":"21.1","5":"198"},{"1":"188.2251","2":"-3.225081918","3":"36.6","4":"17.8","5":"185"},{"1":"187.4755","2":"7.524500903","3":"38.7","4":"19.0","5":"195"},{"1":"187.6214","2":"9.378638152","3":"42.5","4":"20.7","5":"197"},{"1":"183.0924","2":"0.907598192","3":"34.4","4":"18.4","5":"184"},{"1":"190.1960","2":"3.804031949","3":"46.0","4":"21.5","5":"194"},{"1":"188.3885","2":"-14.388544613","3":"37.8","4":"18.3","5":"174"},{"1":"186.9675","2":"-6.967511070","3":"37.7","4":"18.7","5":"180"},{"1":"182.7391","2":"6.260923497","3":"35.9","4":"19.2","5":"189"},{"1":"189.6114","2":"-4.611449398","3":"38.2","4":"18.1","5":"185"},{"1":"193.3578","2":"-13.357762027","3":"38.8","4":"17.2","5":"180"},{"1":"182.8167","2":"4.183325223","3":"35.3","4":"18.9","5":"187"},{"1":"191.5317","2":"-8.531670997","3":"40.6","4":"18.6","5":"183"},{"1":"193.6159","2":"-6.615889115","3":"40.5","4":"17.9","5":"187"},{"1":"187.5790","2":"-15.578963462","3":"37.9","4":"18.6","5":"172"},{"1":"190.4293","2":"-10.429296696","3":"40.5","4":"18.9","5":"180"},{"1":"195.9758","2":"-17.975834264","3":"39.5","4":"16.7","5":"178"},{"1":"188.1475","2":"-10.147483644","3":"37.2","4":"18.1","5":"178"},{"1":"192.4706","2":"-4.470582603","3":"39.5","4":"17.8","5":"188"},{"1":"191.0149","2":"-7.014882997","3":"40.9","4":"18.9","5":"184"},{"1":"190.4816","2":"4.518437298","3":"36.4","4":"17.0","5":"195"},{"1":"181.5156","2":"14.484362106","3":"39.2","4":"21.1","5":"196"},{"1":"184.4353","2":"5.564696746","3":"38.8","4":"20.0","5":"190"},{"1":"194.1927","2":"-14.192675444","3":"42.2","4":"18.5","5":"180"},{"1":"184.9092","2":"-3.909159043","3":"37.6","4":"19.3","5":"181"},{"1":"188.7672","2":"-4.767202184","3":"39.8","4":"19.1","5":"184"},{"1":"187.4414","2":"-5.441366859","3":"36.5","4":"18.0","5":"182"},{"1":"192.4618","2":"2.538217369","3":"40.8","4":"18.4","5":"195"},{"1":"185.1161","2":"0.883912228","3":"36.0","4":"18.5","5":"186"},{"1":"193.1503","2":"2.849700527","3":"44.1","4":"19.7","5":"196"},{"1":"191.6786","2":"-6.678601396","3":"37.0","4":"16.9","5":"185"},{"1":"189.4304","2":"0.569613241","3":"39.6","4":"18.8","5":"190"},{"1":"190.9890","2":"-8.989016906","3":"41.1","4":"19.0","5":"182"},{"1":"186.0374","2":"-7.037399435","3":"37.5","4":"18.9","5":"179"},{"1":"187.0280","2":"2.971956776","3":"36.0","4":"17.9","5":"190"},{"1":"185.7353","2":"5.264727512","3":"42.3","4":"21.2","5":"191"},{"1":"192.9356","2":"-6.935638420","3":"39.6","4":"17.7","5":"186"},{"1":"189.8437","2":"-1.843710394","3":"40.1","4":"18.9","5":"188"},{"1":"185.5641","2":"4.435922530","3":"35.0","4":"17.9","5":"190"},{"1":"190.7133","2":"9.286710125","3":"42.0","4":"19.5","5":"200"},{"1":"184.1948","2":"2.805223890","3":"34.5","4":"18.1","5":"187"},{"1":"192.7028","2":"-1.702843600","3":"41.4","4":"18.6","5":"191"},{"1":"192.6946","2":"-6.694577452","3":"39.0","4":"17.5","5":"186"},{"1":"190.8944","2":"2.105647487","3":"40.6","4":"18.8","5":"193"},{"1":"191.9026","2":"-10.902596245","3":"36.5","4":"16.6","5":"181"},{"1":"185.5465","2":"8.453522474","3":"37.6","4":"19.1","5":"194"},{"1":"189.7754","2":"-4.775445917","3":"35.7","4":"16.9","5":"185"},{"1":"184.5900","2":"10.410034024","3":"41.3","4":"21.1","5":"195"},{"1":"192.2383","2":"-7.238321607","3":"37.6","4":"17.0","5":"185"},{"1":"193.5383","2":"-1.538290841","3":"41.1","4":"18.2","5":"192"},{"1":"190.1629","2":"-6.162903460","3":"36.4","4":"17.1","5":"184"},{"1":"194.9076","2":"-2.907592202","3":"41.6","4":"18.0","5":"192"},{"1":"191.7133","2":"3.286732541","3":"35.5","4":"16.2","5":"195"},{"1":"190.6704","2":"-2.670357664","3":"41.1","4":"19.1","5":"188"},{"1":"191.0242","2":"-1.024216793","3":"35.9","4":"16.6","5":"190"},{"1":"190.7392","2":"7.260844034","3":"41.8","4":"19.4","5":"198"},{"1":"179.8629","2":"10.137122821","3":"33.5","4":"19.0","5":"190"},{"1":"190.8514","2":"-0.851420302","3":"39.7","4":"18.4","5":"190"},{"1":"194.5289","2":"1.471065370","3":"39.6","4":"17.2","5":"196"},{"1":"198.1883","2":"-1.188315190","3":"45.8","4":"18.9","5":"197"},{"1":"187.5707","2":"2.429302685","3":"35.5","4":"17.5","5":"190"},{"1":"195.0711","2":"-0.071054897","3":"42.8","4":"18.5","5":"195"},{"1":"197.7067","2":"-6.706727077","3":"40.9","4":"16.8","5":"191"},{"1":"184.0049","2":"-0.004913499","3":"37.2","4":"19.4","5":"184"},{"1":"193.0567","2":"-6.056702729","3":"36.2","4":"16.1","5":"187"},{"1":"192.1343","2":"2.865676582","3":"42.1","4":"19.1","5":"195"},{"1":"187.2091","2":"1.790894138","3":"34.6","4":"17.2","5":"189"},{"1":"198.0854","2":"-2.085384649","3":"42.9","4":"17.6","5":"196"},{"1":"185.1849","2":"1.815113926","3":"36.7","4":"18.8","5":"187"},{"1":"180.9306","2":"12.069414583","3":"35.1","4":"19.4","5":"193"},{"1":"189.2499","2":"1.750142055","3":"37.3","4":"17.8","5":"191"},{"1":"187.1392","2":"6.860760088","3":"41.3","4":"20.3","5":"194"},{"1":"182.3687","2":"7.631314921","3":"36.3","4":"19.5","5":"190"},{"1":"186.1150","2":"2.885002291","3":"36.9","4":"18.6","5":"189"},{"1":"186.2526","2":"2.747405688","3":"38.3","4":"19.2","5":"189"},{"1":"188.4056","2":"1.594389268","3":"38.9","4":"18.8","5":"190"},{"1":"186.2702","2":"15.729805744","3":"35.7","4":"18.0","5":"202"},{"1":"193.8570","2":"11.143049917","3":"41.1","4":"18.1","5":"205"},{"1":"186.6494","2":"-1.649385652","3":"34.0","4":"17.1","5":"185"},{"1":"191.6610","2":"-5.661001453","3":"39.6","4":"18.1","5":"186"},{"1":"189.2328","2":"-2.232791826","3":"36.2","4":"17.3","5":"187"},{"1":"190.8685","2":"17.131513578","3":"40.8","4":"18.9","5":"208"},{"1":"187.8718","2":"2.128243387","3":"38.1","4":"18.6","5":"190"},{"1":"191.4111","2":"4.588859487","3":"40.3","4":"18.5","5":"196"},{"1":"188.5184","2":"-10.518408893","3":"33.1","4":"16.1","5":"178"},{"1":"195.6566","2":"-3.656641198","3":"43.2","4":"18.5","5":"192"},{"1":"185.5641","2":"6.435922530","3":"35.0","4":"17.9","5":"192"},{"1":"187.6560","2":"15.343972089","3":"41.0","4":"20.0","5":"203"},{"1":"195.5713","2":"-12.571310601","3":"37.7","4":"16.0","5":"183"},{"1":"182.9713","2":"7.028662500","3":"37.8","4":"20.0","5":"190"},{"1":"187.5790","2":"5.421036538","3":"37.9","4":"18.6","5":"193"},{"1":"189.2581","2":"-5.258124093","3":"39.7","4":"18.9","5":"184"},{"1":"193.0650","2":"5.935031124","3":"38.6","4":"17.2","5":"199"},{"1":"183.5569","2":"6.443076199","3":"38.2","4":"20.0","5":"190"},{"1":"192.9703","2":"-11.970304483","3":"38.1","4":"17.0","5":"181"},{"1":"194.0633","2":"2.936655012","3":"43.2","4":"19.0","5":"197"},{"1":"194.5636","2":"3.436399307","3":"38.1","4":"16.5","5":"198"},{"1":"193.4343","2":"-2.434292652","3":"45.6","4":"20.3","5":"191"},{"1":"193.0820","2":"-0.082034996","3":"39.7","4":"17.7","5":"193"},{"1":"191.0061","2":"5.993916975","3":"42.2","4":"19.5","5":"197"},{"1":"183.3759","2":"7.624138837","3":"39.6","4":"20.7","5":"191"},{"1":"195.5620","2":"0.438023195","3":"42.7","4":"18.3","5":"196"},{"1":"193.7023","2":"-5.702287360","3":"38.6","4":"17.0","5":"188"},{"1":"180.6461","2":"18.353941586","3":"37.3","4":"20.5","5":"199"},{"1":"189.4568","2":"-0.456786675","3":"35.7","4":"17.0","5":"189"},{"1":"192.2637","2":"-3.263653874","3":"41.1","4":"18.6","5":"189"},{"1":"189.5515","2":"-2.551451068","3":"36.2","4":"17.2","5":"187"},{"1":"183.4623","2":"14.537740592","3":"37.7","4":"19.8","5":"198"},{"1":"196.0446","2":"-20.044632566","3":"40.2","4":"17.0","5":"176"},{"1":"193.0215","2":"8.978497158","3":"41.4","4":"18.5","5":"202"},{"1":"192.2301","2":"-6.230055459","3":"35.2","4":"15.9","5":"186"},{"1":"190.2570","2":"8.742965971","3":"40.6","4":"19.0","5":"199"},{"1":"192.0831","2":"-1.083125059","3":"38.8","4":"17.6","5":"191"},{"1":"193.8052","2":"1.194782099","3":"41.5","4":"18.3","5":"195"},{"1":"193.9692","2":"-2.969214420","3":"39.0","4":"17.1","5":"191"},{"1":"198.5675","2":"11.432493414","3":"44.1","4":"18.0","5":"210"},{"1":"190.6880","2":"-0.687957608","3":"38.5","4":"17.9","5":"190"},{"1":"193.2796","2":"3.720370071","3":"43.1","4":"19.2","5":"197"},{"1":"186.2873","2":"6.712739625","3":"36.8","4":"18.5","5":"193"},{"1":"187.3120","2":"11.687963597","3":"37.5","4":"18.5","5":"199"},{"1":"191.0583","2":"-4.058349032","3":"38.1","4":"17.6","5":"187"},{"1":"195.7689","2":"-5.768905535","3":"41.1","4":"17.5","5":"190"},{"1":"187.7171","2":"3.282906110","3":"35.6","4":"17.5","5":"191"},{"1":"186.1662","2":"13.833803933","3":"40.2","4":"20.1","5":"200"},{"1":"192.9532","2":"-7.953238364","3":"37.0","4":"16.5","5":"185"},{"1":"192.4447","2":"0.555283488","3":"39.7","4":"17.9","5":"193"},{"1":"195.7260","2":"-2.725973324","3":"40.2","4":"17.1","5":"193"},{"1":"195.9929","2":"-8.992900384","3":"40.6","4":"17.2","5":"187"},{"1":"188.9664","2":"-0.966398591","3":"32.1","4":"15.5","5":"188"},{"1":"196.7766","2":"-6.776615443","3":"40.7","4":"17.0","5":"190"},{"1":"192.4365","2":"-0.436450364","3":"37.3","4":"16.8","5":"192"},{"1":"188.8707","2":"-3.870666549","3":"39.0","4":"18.7","5":"185"},{"1":"189.4821","2":"0.517881058","3":"39.2","4":"18.6","5":"190"},{"1":"186.3131","2":"-2.313126466","3":"36.6","4":"18.4","5":"184"},{"1":"187.3467","2":"7.653297534","3":"36.0","4":"17.8","5":"195"},{"1":"189.0259","2":"3.974136904","3":"37.8","4":"18.1","5":"193"},{"1":"189.5773","2":"-2.577317159","3":"36.0","4":"17.1","5":"187"},{"1":"193.1679","2":"7.832100583","3":"41.5","4":"18.5","5":"201"},{"1":"216.7911","2":"-5.791081705","3":"46.1","4":"13.2","5":"211"},{"1":"212.6221","2":"17.377888356","3":"50.0","4":"16.3","5":"230"},{"1":"217.7295","2":"-7.729459487","3":"48.7","4":"14.1","5":"210"},{"1":"216.1274","2":"1.872636694","3":"50.0","4":"15.2","5":"218"},{"1":"214.8445","2":"0.155539810","3":"47.6","4":"14.5","5":"215"},{"1":"216.4207","2":"-6.420690281","3":"46.5","4":"13.5","5":"210"},{"1":"211.3051","2":"-0.305076291","3":"45.4","4":"14.6","5":"211"},{"1":"210.9776","2":"8.022382923","3":"46.7","4":"15.3","5":"219"},{"1":"212.0547","2":"-3.054659111","3":"43.3","4":"13.4","5":"209"},{"1":"210.8054","2":"4.194645590","3":"46.8","4":"15.4","5":"215"},{"1":"207.5852","2":"6.414836423","3":"40.9","4":"13.7","5":"214"},{"1":"211.7955","2":"4.204535625","3":"49.0","4":"16.1","5":"216"},{"1":"214.3194","2":"-0.319406043","3":"45.5","4":"13.7","5":"214"},{"1":"215.6970","2":"-2.696973551","3":"48.4","4":"14.6","5":"213"},{"1":"211.8907","2":"-1.890662592","3":"45.8","4":"14.6","5":"210"},{"1":"213.5093","2":"3.490708932","3":"49.3","4":"15.7","5":"217"},{"1":"209.8328","2":"0.167155611","3":"42.0","4":"13.5","5":"210"},{"1":"214.9562","2":"6.043809297","3":"49.2","4":"15.2","5":"221"},{"1":"212.7949","2":"-3.794908135","3":"46.2","4":"14.5","5":"209"},{"1":"214.5429","2":"7.457132932","3":"48.7","4":"15.1","5":"222"},{"1":"219.2881","2":"-1.288089633","3":"50.2","4":"14.3","5":"218"},{"1":"211.1845","2":"3.815454194","3":"45.1","4":"14.5","5":"215"},{"1":"213.2341","2":"-0.234097861","3":"46.5","4":"14.5","5":"213"},{"1":"208.7987","2":"6.201265434","3":"46.3","4":"15.8","5":"215"},{"1":"212.4251","2":"2.574949465","3":"42.9","4":"13.1","5":"215"},{"1":"210.7366","2":"4.263443892","3":"46.1","4":"15.1","5":"215"},{"1":"210.9435","2":"5.056515162","3":"44.5","4":"14.3","5":"216"},{"1":"213.5440","2":"1.456042869","3":"47.8","4":"15.0","5":"215"},{"1":"216.3602","2":"-6.360158126","3":"48.2","4":"14.3","5":"210"},{"1":"215.8087","2":"4.191295936","3":"50.0","4":"15.3","5":"220"},{"1":"211.8560","2":"10.144003471","3":"47.3","4":"15.3","5":"222"},{"1":"208.7734","2":"0.226597701","3":"42.8","4":"14.2","5":"209"},{"1":"211.1845","2":"-4.184545806","3":"45.1","4":"14.5","5":"207"},{"1":"216.0844","2":"3.915568905","3":"49.1","4":"14.8","5":"220"},{"1":"210.2798","2":"9.720233561","3":"48.4","4":"16.3","5":"220"},{"1":"210.0739","2":"2.926094642","3":"42.6","4":"13.7","5":"213"},{"1":"201.2373","2":"17.762688995","3":"44.4","4":"17.3","5":"219"},{"1":"212.4421","2":"-4.442116655","3":"44.0","4":"13.6","5":"208"},{"1":"212.6309","2":"-4.630911616","3":"48.7","4":"15.7","5":"208"},{"1":"210.2203","2":"-2.220301933","3":"42.7","4":"13.7","5":"208"},{"1":"212.9925","2":"12.007496931","3":"49.6","4":"16.0","5":"225"},{"1":"214.0266","2":"-4.026612892","3":"45.3","4":"13.7","5":"210"},{"1":"216.1791","2":"-0.179095488","3":"49.6","4":"15.0","5":"216"},{"1":"214.6287","2":"7.371268511","3":"50.5","4":"15.9","5":"222"},{"1":"210.9006","2":"6.099447373","3":"43.6","4":"13.9","5":"217"},{"1":"213.6821","2":"-3.682087559","3":"45.5","4":"13.9","5":"210"},{"1":"214.6287","2":"10.371268511","3":"50.5","4":"15.9","5":"225"},{"1":"214.7157","2":"-1.715663559","3":"44.9","4":"13.3","5":"213"},{"1":"207.1884","2":"7.811627763","3":"45.2","4":"15.8","5":"215"},{"1":"214.3365","2":"-4.336472162","3":"46.6","4":"14.2","5":"210"},{"1":"217.4367","2":"2.563333664","3":"48.5","4":"14.1","5":"220"},{"1":"211.5032","2":"-1.503205048","3":"45.1","4":"14.4","5":"210"},{"1":"216.9111","2":"8.088921635","3":"50.1","4":"15.0","5":"225"},{"1":"213.5528","2":"3.447242897","3":"46.5","4":"14.4","5":"217"},{"1":"208.1702","2":"11.829783946","3":"45.0","4":"15.4","5":"220"},{"1":"211.1933","2":"-3.193345778","3":"43.8","4":"13.9","5":"208"},{"1":"210.1768","2":"9.823164102","3":"45.5","4":"15.0","5":"220"},{"1":"208.4030","2":"-0.403010875","3":"43.2","4":"14.5","5":"208"},{"1":"216.3943","2":"7.605709635","3":"50.4","4":"15.3","5":"224"},{"1":"213.7080","2":"-5.707953650","3":"45.3","4":"13.8","5":"208"},{"1":"211.5203","2":"9.479728832","3":"46.2","4":"14.9","5":"221"},{"1":"213.9749","2":"0.025119290","3":"45.7","4":"13.9","5":"214"},{"1":"220.8291","2":"10.170880164","3":"54.3","4":"15.7","5":"231"},{"1":"213.1653","2":"5.834700440","3":"45.8","4":"14.2","5":"219"},{"1":"210.7360","2":"19.263977716","3":"49.8","4":"16.8","5":"230"},{"1":"213.1136","2":"0.886432623","3":"46.2","4":"14.4","5":"214"},{"1":"212.2088","2":"16.791211990","3":"49.5","4":"16.2","5":"229"},{"1":"209.7982","2":"10.201821674","3":"43.5","4":"14.2","5":"220"},{"1":"217.7895","2":"5.210542183","3":"50.7","4":"15.0","5":"223"},{"1":"213.3976","2":"2.602439444","3":"47.7","4":"15.0","5":"216"},{"1":"209.5824","2":"11.417550375","3":"46.4","4":"15.6","5":"221"},{"1":"212.2176","2":"8.782412019","3":"48.2","4":"15.6","5":"221"},{"1":"212.2781","2":"4.721879864","3":"46.5","4":"14.8","5":"217"},{"1":"211.4944","2":"4.505594924","3":"46.4","4":"15.0","5":"216"},{"1":"211.5285","2":"18.471462685","3":"48.6","4":"16.0","5":"230"},{"1":"215.6540","2":"-6.654041341","3":"47.5","4":"14.2","5":"209"},{"1":"214.2325","2":"5.767526027","3":"51.1","4":"16.3","5":"220"},{"1":"213.5616","2":"1.438442925","3":"45.2","4":"13.8","5":"215"},{"1":"205.2764","2":"17.723583215","3":"45.2","4":"16.4","5":"223"},{"1":"217.0404","2":"-5.040408821","3":"49.1","4":"14.5","5":"212"},{"1":"218.5126","2":"2.487359278","3":"52.5","4":"15.6","5":"221"},{"1":"214.2330","2":"-2.233007798","3":"47.4","4":"14.6","5":"212"},{"1":"213.8967","2":"10.103251388","3":"50.0","4":"15.9","5":"224"},{"1":"213.1224","2":"-1.122367349","3":"44.9","4":"13.8","5":"212"},{"1":"210.6067","2":"17.393308172","3":"50.8","4":"17.3","5":"228"},{"1":"209.0145","2":"8.985536733","3":"43.4","4":"14.4","5":"218"},{"1":"221.2171","2":"-3.217111204","3":"51.3","4":"14.2","5":"218"},{"1":"216.2914","2":"-4.291359825","3":"47.5","4":"14.0","5":"212"},{"1":"213.4658","2":"16.534174966","3":"52.1","4":"17.0","5":"230"},{"1":"213.1048","2":"4.895232595","3":"47.5","4":"15.0","5":"218"},{"1":"213.2936","2":"14.706437633","3":"52.2","4":"17.1","5":"228"},{"1":"211.7701","2":"0.229867892","3":"45.5","4":"14.5","5":"212"},{"1":"212.5274","2":"11.472552748","3":"49.5","4":"16.1","5":"224"},{"1":"209.6688","2":"4.331152130","3":"44.5","4":"14.7","5":"214"},{"1":"215.7052","2":"10.294760301","3":"50.8","4":"15.7","5":"226"},{"1":"213.3370","2":"2.662971598","3":"49.4","4":"15.8","5":"216"},{"1":"213.5010","2":"8.498975079","3":"46.9","4":"14.6","5":"222"},{"1":"216.3343","2":"-13.334292035","3":"48.4","4":"14.4","5":"203"},{"1":"213.5952","2":"11.404844510","3":"51.1","4":"16.5","5":"225"},{"1":"214.5687","2":"4.431266841","3":"48.5","4":"15.0","5":"219"},{"1":"219.0289","2":"8.971105103","3":"55.9","4":"17.0","5":"228"},{"1":"211.0723","2":"3.927718530","3":"47.2","4":"15.5","5":"215"},{"1":"215.4471","2":"12.552887389","3":"49.1","4":"15.0","5":"228"},{"1":"216.6359","2":"-0.635885158","3":"47.3","4":"13.8","5":"216"},{"1":"208.5747","2":"6.425260283","3":"46.8","4":"16.1","5":"215"},{"1":"205.5697","2":"4.430256240","3":"41.7","4":"14.7","5":"210"},{"1":"219.1929","2":"-0.192891416","3":"53.4","4":"15.8","5":"219"},{"1":"210.1427","2":"-2.142703659","3":"43.3","4":"14.0","5":"208"},{"1":"213.6645","2":"-4.664487616","3":"48.1","4":"15.1","5":"209"},{"1":"216.8593","2":"-0.859346182","3":"50.5","4":"15.2","5":"216"},{"1":"213.6040","2":"15.396044539","3":"49.8","4":"15.9","5":"229"},{"1":"206.6116","2":"6.388414093","3":"43.5","4":"15.2","5":"213"},{"1":"214.8181","2":"15.181939725","3":"51.5","4":"16.3","5":"230"},{"1":"214.0695","2":"2.930454897","3":"46.2","4":"14.1","5":"217"},{"1":"221.0443","2":"8.955685287","3":"55.1","4":"16.0","5":"230"},{"1":"206.4823","2":"10.517744549","3":"44.5","4":"15.7","5":"217"},{"1":"211.1840","2":"10.815988018","3":"48.8","4":"16.2","5":"222"},{"1":"216.8081","2":"-2.808147824","3":"47.2","4":"13.7","5":"214"},{"1":"214.3106","2":"0.689393929","3":"46.8","4":"14.3","5":"215"},{"1":"215.1197","2":"6.880346603","3":"50.4","4":"15.7","5":"222"},{"1":"210.3750","2":"1.625035344","3":"45.2","4":"14.8","5":"212"},{"1":"213.1130","2":"-0.113033553","3":"49.9","4":"16.1","5":"213"},{"1":"202.3997","2":"-10.399683636","3":"46.5","4":"17.9","5":"192"},{"1":"202.4250","2":"-6.425015903","3":"50.0","4":"19.5","5":"196"},{"1":"205.2841","2":"-12.284149109","3":"51.3","4":"19.2","5":"193"},{"1":"198.2400","2":"-10.240047372","3":"45.4","4":"18.7","5":"188"},{"1":"205.4217","2":"-8.421745712","3":"52.7","4":"19.8","5":"197"},{"1":"200.8152","2":"-2.815187399","3":"45.2","4":"17.8","5":"198"},{"1":"200.8581","2":"-22.858119609","3":"46.1","4":"18.2","5":"178"},{"1":"208.4707","2":"-11.470741528","3":"51.3","4":"18.2","5":"197"},{"1":"198.4811","2":"-3.481108340","3":"46.0","4":"18.9","5":"195"},{"1":"203.0535","2":"-5.053534415","3":"51.3","4":"19.9","5":"198"},{"1":"202.8647","2":"-9.864739454","3":"46.6","4":"17.8","5":"193"},{"1":"202.3645","2":"-8.364483749","3":"51.7","4":"20.3","5":"194"},{"1":"205.0436","2":"-20.043621965","3":"47.0","4":"17.3","5":"185"},{"1":"209.8142","2":"-8.814176797","3":"52.0","4":"18.1","5":"201"},{"1":"204.0706","2":"-14.070578119","3":"45.9","4":"17.1","5":"190"},{"1":"202.8383","2":"-1.838339538","3":"50.5","4":"19.6","5":"201"},{"1":"201.2709","2":"-4.270909420","3":"50.3","4":"20.0","5":"197"},{"1":"200.0227","2":"-10.022672368","3":"46.4","4":"18.6","5":"190"},{"1":"205.3964","2":"-10.396413445","3":"49.2","4":"18.2","5":"195"},{"1":"198.3094","2":"-17.309379498","3":"42.4","4":"17.3","5":"181"},{"1":"206.6023","2":"-15.602252111","3":"48.5","4":"17.5","5":"191"},{"1":"201.7112","2":"-14.711166794","3":"43.2","4":"16.6","5":"187"},{"1":"203.6221","2":"-10.622054597","3":"50.6","4":"19.4","5":"193"},{"1":"202.6925","2":"-7.692476787","3":"46.7","4":"17.9","5":"195"},{"1":"206.9462","2":"-9.946243620","3":"52.0","4":"19.0","5":"197"},{"1":"206.6623","2":"-6.662250441","3":"50.5","4":"18.4","5":"200"},{"1":"203.2863","2":"-3.286329236","3":"49.5","4":"19.0","5":"200"},{"1":"202.5719","2":"-11.571946303","3":"46.4","4":"17.8","5":"191"},{"1":"204.9308","2":"0.069176196","3":"52.8","4":"20.0","5":"205"},{"1":"198.3440","2":"-11.344045561","3":"40.9","4":"16.6","5":"187"},{"1":"204.4311","2":"-3.431101923","3":"54.2","4":"20.8","5":"201"},{"1":"200.3677","2":"-13.367731525","3":"42.5","4":"16.7","5":"187"},{"1":"206.1196","2":"-3.119596350","3":"51.0","4":"18.8","5":"203"},{"1":"204.8538","2":"-9.853759354","3":"49.7","4":"18.6","5":"195"},{"1":"207.3689","2":"-8.368901051","3":"47.5","4":"16.8","5":"199"},{"1":"202.7354","2":"-7.735408998","3":"47.6","4":"18.3","5":"195"},{"1":"201.5290","2":"8.470963493","3":"52.0","4":"20.7","5":"210"},{"1":"207.1278","2":"-15.127840083","3":"46.9","4":"16.6","5":"192"},{"1":"206.2743","2":"-1.274259073","3":"53.5","4":"19.9","5":"205"},{"1":"200.9611","2":"9.038949850","3":"49.0","4":"19.5","5":"210"},{"1":"203.2351","2":"-16.235130878","3":"46.2","4":"17.5","5":"187"},{"1":"205.0172","2":"-9.017222049","3":"50.9","4":"19.1","5":"196"},{"1":"203.8037","2":"-7.803651060","3":"45.5","4":"17.0","5":"196"},{"1":"208.8411","2":"-12.841132952","3":"50.9","4":"17.9","5":"196"},{"1":"206.7828","2":"-5.782780925","3":"50.8","4":"18.5","5":"201"},{"1":"207.6700","2":"-17.669960349","3":"50.1","4":"17.9","5":"190"},{"1":"200.6424","2":"11.357609092","3":"49.0","4":"19.6","5":"212"},{"1":"207.1702","2":"-20.170238469","3":"51.5","4":"18.7","5":"187"},{"1":"209.1427","2":"-11.142726075","3":"49.8","4":"17.3","5":"198"},{"1":"209.5219","2":"-10.521917471","3":"48.1","4":"16.4","5":"199"},{"1":"206.0679","2":"-5.067864168","3":"51.4","4":"19.0","5":"201"},{"1":"203.1405","2":"-10.140466485","3":"45.7","4":"17.3","5":"193"},{"1":"202.8125","2":"0.187526553","3":"50.7","4":"19.7","5":"203"},{"1":"198.4558","2":"-11.455776073","3":"42.5","4":"17.3","5":"187"},{"1":"207.8764","2":"-10.876355255","3":"52.2","4":"18.8","5":"197"},{"1":"204.6391","2":"-13.639098302","3":"45.2","4":"16.6","5":"191"},{"1":"200.1256","2":"2.874397092","3":"49.3","4":"19.9","5":"203"},{"1":"204.9484","2":"-2.948423747","3":"50.2","4":"18.8","5":"202"},{"1":"196.3022","2":"-2.302225829","3":"45.6","4":"19.4","5":"194"},{"1":"205.2066","2":"0.793449165","3":"51.9","4":"19.5","5":"206"},{"1":"207.3001","2":"-18.300102749","3":"46.8","4":"16.5","5":"189"},{"1":"204.0964","2":"-9.096444211","3":"45.7","4":"17.0","5":"195"},{"1":"209.9600","2":"-2.960039548","3":"55.8","4":"19.8","5":"207"},{"1":"197.3705","2":"4.629532108","3":"43.5","4":"18.1","5":"202"},{"1":"205.9820","2":"-12.981999747","3":"49.6","4":"18.2","5":"193"},{"1":"205.1895","2":"4.810515284","3":"50.8","4":"19.0","5":"210"},{"1":"205.2671","2":"-7.267082989","3":"50.2","4":"18.7","5":"198"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"r.squared","2":"0.6414296300159142427688152565679047256708145141601562500000000000000000000000000000"},{"1":"adj.r.squared","2":"0.6393016159507267648365314016700722277164459228515625000000000000000000000000000000"},{"1":"sigma","2":"8.3916612522704632226577814435586333274841308593750000000000000000000000000000000000"},{"1":"statistic","2":"301.4217060446975438026129268109798431396484375000000000000000000000000000000000000000"},{"1":"p.value","2":"0.0000000000000000000000000000000000000000000000000000000000000000000000000008826454"},{"1":"df","2":"2.0000000000000000000000000000000000000000000000000000000000000000000000000000000000"},{"1":"logLik","2":"-1204.1935360623369888344313949346542358398437500000000000000000000000000000000000000000"},{"1":"AIC","2":"2416.3870721246739776688627898693084716796875000000000000000000000000000000000000000000"},{"1":"BIC","2":"2431.7028545951147862069774419069290161132812500000000000000000000000000000000000000000"},{"1":"deviance","2":"23731.5327790529663616325706243515014648437500000000000000000000000000000000000000000000"},{"1":"df.residual","2":"337.0000000000000000000000000000000000000000000000000000000000000000000000000000000000"},{"1":"nobs","2":"340.0000000000000000000000000000000000000000000000000000000000000000000000000000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">&lt;-</span> <span class="va">fit</span> <span class="op">|&gt;</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu"><a href="https://hardhat.tidymodels.org/reference/hardhat-extract.html">extract_fit_engine</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = ..y ~ ., data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -22.8581  -5.7849  -0.0765   6.0064  23.2186 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value            Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    191.36528    6.25580   30.59 &lt;0.0000000000000002 ***</span></span>
<span><span class="co">#&gt; bill_length_mm   1.46397    0.08774   16.68 &lt;0.0000000000000002 ***</span></span>
<span><span class="co">#&gt; bill_depth_mm   -3.18659    0.23723  -13.43 &lt;0.0000000000000002 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 8.392 on 337 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6414, Adjusted R-squared:  0.6393 </span></span>
<span><span class="co">#&gt; F-statistic: 301.4 on 2 and 337 DF,  p-value: &lt; 0.00000000000000022</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, <span class="va">.pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Observed"</span>, y <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-fit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Relation between fitted and predicted values.
</figcaption></figure>
</div>
</section><section id="performing-residual-diagnostics" class="level2"><h2 class="anchored" data-anchor-id="performing-residual-diagnostics">Performing residual diagnostics</h2>
<section id="normality" class="level3"><h3 class="anchored" data-anchor-id="normality">Normality</h3>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats_sum</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-stats" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Statistics about the model residuals.
</figcaption><div aria-describedby="tbl-model-residual-diag-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["value"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"name","2":"Residuals"},{"1":"n","2":"340"},{"1":"n_rm_na","2":"340"},{"1":"n_na","2":"0"},{"1":"mean","2":"-0.000000000000000678345757833184"},{"1":"var","2":"70.0045214721326"},{"1":"sd","2":"8.36687047061998"},{"1":"min","2":"-22.8581196091446"},{"1":"q_1","2":"-5.78485612013035"},{"1":"median","2":"-0.0765449461938063"},{"1":"q_3","2":"6.00639005535884"},{"1":"max","2":"23.2186045725256"},{"1":"iqr","2":"11.7912461754892"},{"1":"skewness","2":"-0.0139844383232328"},{"1":"kurtosis","2":"2.7178750413236"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>It is important to note that the Kolmogorov-Smirnov and Pearson chi-square test are here just for reference since many authors don’t recommend using them when testing for normality <span class="citation" data-cites="dagostino1990">(<a href="#ref-dagostino1990" role="doc-biblioref">D’Agostino &amp; Belanger, 1990</a>)</span>.</p>
<p>Learn more about normality tests in <span class="citation" data-cites="thode2002">Thode (<a href="#ref-thode2002" role="doc-biblioref">2002</a>)</span>.</p>
<p><span class="math display">\[
\begin{cases}
\text{H}_{0}: \text{Normality} \\
\text{H}_{a}: \text{Nonnormality}
\end{cases}
\]</span></p>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">normality_sum</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-model-residual-diag-normality-tests" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-residual-diag-normality-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Normality tests about the model residuals
</figcaption><div aria-describedby="tbl-model-residual-diag-normality-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["test"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Anderson-Darling","2":"0.9521389"},{"1":"Bonett-Seier","2":"0.4189986"},{"1":"Cramer-von Mises","2":"0.9692445"},{"1":"D'Agostino Omnibus Test","2":"0.5593831"},{"1":"D'Agostino Skewness Test","2":"0.9144127"},{"1":"D'Agostino Kurtosis Test","2":"0.2834883"},{"1":"Jarque–Bera","2":"0.5659015"},{"1":"Lilliefors (K-S)","2":"0.9605605"},{"1":"Pearson chi-square","2":"0.5231050"},{"1":"Shapiro-Francia","2":"0.8689058"},{"1":"Shapiro-Wilk","2":"0.9473604"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>Correlation between observed residuals and expected residuals under normality.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_correlation.html">ols_test_correlation</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9990882</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">test_normality</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-correlation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution
</figcaption></figure>
</div>
</section><section id="common-variance" class="level3"><h3 class="anchored" data-anchor-id="common-variance">Common variance</h3>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html">augment</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted values"</span>, y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-fit-values-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-fit-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-fit-values-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Relation between the fitted values of the restricted model and its residuals
</figcaption></figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">.resid_sd_error</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">fit_engine</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html">deviance</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">`/`</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">.resid_sd_error</span></span>
<span><span class="co">#&gt; [1] 0.4571229</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    .sd_resid <span class="op">=</span> </span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard</a></span><span class="op">(</span><span class="va">fit_engine</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">.pred</span>, <span class="va">.sd_resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Fitted values"</span>, </span>
<span>    y <span class="op">=</span> <span class="fu">latex2exp</span><span class="fu">::</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$\\sqrt{Standardized \\ Residuals}$"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-model-residual-diag-fit-values-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-fit-values-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-fit-values-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Relation between the fitted values of the model and its standardized residuals
</figcaption></figure>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># fit_engine |&gt; lmtest::bptest()</span></span>
<span></span>
<span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_breusch_pagan.html">ols_test_breusch_pagan</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch Pagan Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  -----------------------------------------</span></span>
<span><span class="co">#&gt;  Ho: the variance is constant            </span></span>
<span><span class="co">#&gt;  Ha: the variance is not constant        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Data               </span></span>
<span><span class="co">#&gt;  -------------------------------</span></span>
<span><span class="co">#&gt;  Response : ..y </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ..y </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary          </span></span>
<span><span class="co">#&gt;  -----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    0.09240047 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    0.7611474</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_test_score.html">ols_test_score</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Score Test for Heteroskedasticity</span></span>
<span><span class="co">#&gt;  ---------------------------------</span></span>
<span><span class="co">#&gt;  Ho: Variance is homogenous</span></span>
<span><span class="co">#&gt;  Ha: Variance is not homogenous</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Variables: fitted values of ..y </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Test Summary         </span></span>
<span><span class="co">#&gt;  ----------------------------</span></span>
<span><span class="co">#&gt;  DF            =    1 </span></span>
<span><span class="co">#&gt;  Chi2          =    0.1075753 </span></span>
<span><span class="co">#&gt;  Prob &gt; Chi2   =    0.7429217</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="independence" class="level3"><h3 class="anchored" data-anchor-id="independence">Independence</h3>
<dl>
<dt>Variance inflation factor (VIF)</dt>
<dd>
“Indicator of the effect that the other independent variables have on the standard error of a regression coefficient. The variance inflation factor is directly related to the tolerance value (<span class="math inline">\(\text{VIF}_{i} = 1/\text{TO}L\)</span>). Large VIF values also indicate a high degree of collinearity or multicollinearity among the independent variables” <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 265</a>)</span>.
</dd>
</dl>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_coll_diag.html">ols_coll_diag</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tolerance and Variance Inflation Factor</span></span>
<span><span class="co">#&gt; ---------------------------------------</span></span>
<span><span class="co">#&gt;        Variables Tolerance      VIF</span></span>
<span><span class="co">#&gt; 1 bill_length_mm 0.9412773 1.062386</span></span>
<span><span class="co">#&gt; 2  bill_depth_mm 0.9412773 1.062386</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Eigenvalue and Condition Index</span></span>
<span><span class="co">#&gt; ------------------------------</span></span>
<span><span class="co">#&gt;    Eigenvalue Condition Index    intercept bill_length_mm bill_depth_mm</span></span>
<span><span class="co">#&gt; 1 2.979217377         1.00000 0.0005948731    0.001539628   0.001378893</span></span>
<span><span class="co">#&gt; 2 0.017263355        13.13677 0.0002142314    0.414383774   0.343919362</span></span>
<span><span class="co">#&gt; 3 0.003519268        29.09544 0.9991908955    0.584076598   0.654701745</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="measures-of-influence" class="level3"><h3 class="anchored" data-anchor-id="measures-of-influence">Measures of influence</h3>
<dl>
<dt>Leverage points</dt>
<dd>
“Type of <em>influential observation</em> defined by one aspect of influence termed <em>leverage</em>. These observations are substantially different on one or more independent variables, so that they affect the estimation of one or more <em>regression coefficients</em>” <span class="citation" data-cites="hair2019">(<a href="#ref-hair2019" role="doc-biblioref">Hair, 2019, p. 262</a>)</span>.
</dd>
</dl>
<div id="fig-model-residual-diag-leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-model-residual-diag-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_engine</span> <span class="op">|&gt;</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_resid_lev.html">ols_plot_resid_lev</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-residual-diag-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Relation between the model studentized residuals and their leverage/influence points.
</figcaption></figure>
</div>
</section></section><section id="references" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-dagostino1990" class="csl-entry" role="listitem">
D’Agostino, R. B., &amp; Belanger, A. (1990). A suggestion for using powerful and informative tests of normality. <em>The American Statistician</em>, <em>44</em>(4), 316–321. <a href="https://doi.org/10.2307/2684359">https://doi.org/10.2307/2684359</a>
</div>
<div id="ref-degroot2012" class="csl-entry" role="listitem">
DeGroot, M. H., &amp; Schervish, M. J. (2012). <em>Probability and statistics</em> (4th ed.). Addison-Wesley.
</div>
<div id="ref-gorman2014" class="csl-entry" role="listitem">
Gorman, K. B., Williams, T. D., &amp; Fraser, W. R. (2014). Ecological sexual dimorphism and environmental variability within a community of antarctic penguins (genus pygoscelis). <em>PLOS ONE</em>, <em>9</em>(3), e90081. <a href="https://doi.org/10.1371/journal.pone.0090081">https://doi.org/10.1371/journal.pone.0090081</a>
</div>
<div id="ref-hair2019" class="csl-entry" role="listitem">
Hair, J. F. (2019). <em>Multivariate data analysis</em> (8th ed.). Cengage.
</div>
<div id="ref-thode2002" class="csl-entry" role="listitem">
Thode, H. C. (2002). <em>Testing for normality</em>. Marcel Dekker.
</div>
</div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/danielvartan\.github\.io\/linear-model\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb40" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: setup</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| include: false</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="in">source(here::here("R/quarto-setup.R"))</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- badges: start --&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="al">![Project Status: Inactive – The project has reached a stable, usable state but is no longer being actively developed; support/maintenance will be provided as time allows.](https://www.repostatus.org/badges/latest/inactive.svg)</span><span class="co">](https://www.repostatus.org/#inactive)</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="al">![License: MIT](https://img.shields.io/badge/license-MIT-green)</span><span class="co">](https://choosealicense.com/licenses/mit/)</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- badges: end --&gt;</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>This document focuses on demonstrating <span class="co">[</span><span class="ot">general linear models</span><span class="co">](https://en.wikipedia.org/wiki/General_linear_model)</span>, with a particular emphasis on multiple regression. The <span class="co">[</span><span class="ot">`penguins`</span><span class="co">](https://allisonhorst.github.io/palmerpenguins/reference/penguins.html)</span> dataset from the <span class="co">[</span><span class="ot">`palmerpenguins`</span><span class="co">](https://github.com/allisonhorst/palmerpenguins/)</span> package in R, containing measurements of penguin species inhabiting the <span class="co">[</span><span class="ot">Palmer Archipelago</span><span class="co">](https://en.wikipedia.org/wiki/Palmer_Archipelago)</span>, is used. The dataset was originally introduced by @gorman2014.</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>::: {#fig-penguins-1}</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/palmer_penguins.png)</span>{fig-align="center" width="75%"}</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>Artwork by <span class="co">[</span><span class="ot">Allison Horst</span><span class="co">](https://allisonhorst.com/)</span>.</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>**Can Bill length and Bill depth predict Flipper length?**</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>The goal is to test whether the variables <span class="in">`bill_length_mm`</span> and <span class="in">`bill_depth_mm`</span> are good predictors of <span class="in">`flipper_length_mm`</span>. The definitions of these variables are provided below:</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bill_length_mm`</span>: numerical value representing bill length in millimeters.</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`bill_depth_mm`</span>: numerical value representing bill depth in millimeters.</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`flipper_length_mm`</span>: integer value representing flipper length in millimeters.</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>::: {#fig-penguins-2}</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/culmen_depth.png)</span>{fig-align="center"width="75%"}</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>Artwork by <span class="co">[</span><span class="ot">Allison Horst</span><span class="co">](https://allisonhorst.com/)</span>.</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## A brief look on general linear models</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; See @degroot2012 </span><span class="co">[</span><span class="ot">pp. 699-707, pp. 736-754</span><span class="co">]</span><span class="at"> and @hair2019 </span><span class="co">[</span><span class="ot">pp. 259-370</span><span class="co">]</span><span class="at"> to learn more.</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>"<span class="co">[</span><span class="ot">...</span><span class="co">]</span> A problem of this type is called a problem of multiple linear regression because we are considering the regression of $Y$ on $k$ variables $X_{1}, \dots, X_{k}$, rather than on just a single variable $X$, and we are assuming also that this regression is a linear function of the parameters $\beta_{0}, \dots, \beta_{k}$. In a problem of multiple linear regressions, we obtain $n$ vectors of observations ($x_{i1}. \dots, x_{ik}, Y_{i}$), for $i = 1, \dots, n$. Here $x_{ij}$ is the observed value of the variable $X_{j}$ for the $i$th observation. The $E(Y)$ is given by the relation</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>E(Y_{i}) = \beta_{0} + \beta_{1} x_{i1} + \dots + \beta_{k} x_{ik}</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@degroot2012, p. 738</span><span class="co">]</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definitions</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>Residuals/Fitted Values</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} For $i = 1, \dots, n$, the observed values of $\hat{y} = \hat{\beta}_{0} + \hat{\beta}_{1} x_{i}$ are called _fitted values_. For $i = 1, \dots, n$, the observed values of $e_{i} = y_{i} - \hat{y}_{i}$ are called _residuals_ <span class="co">[</span><span class="ot">@degroot2012, p. 717</span><span class="co">]</span>.</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>"<span class="co">[</span><span class="ot">...</span><span class="co">]</span> regression problems in which the observations $Y_{i}, \dots, Y_{n}$ <span class="co">[</span><span class="ot">...</span><span class="co">]</span> we shall assume that each observation $Y_{i}$ has a normal distribution, that the observations $Y_{1}, \dots, Y_{n}$ are independent, and that the observations $Y_{1}, \dots, Y_{n}$ have the same variance $\sigma^{2}$. Instead of a single predictor being associated with each $Y_{i}$, we assume that a $p$-dimensional vector $z_{i} = (z_{i0}, \dots, z_{ip - 1})$ is associated with each $Y_{i}$"  <span class="co">[</span><span class="ot">@degroot2012, p. 736</span><span class="co">]</span>.</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>General Linear Model</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>: The statistical model in which the observations $Y_{1}, \dots, Y_{n}$ satisfy the following assumptions <span class="co">[</span><span class="ot">@degroot2012, p. 738</span><span class="co">]</span>.</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assumptions</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>Assumption 1</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Predictor is known__. Either the vectors $z_{1}, \dots , z_{n}$ are known ahead of time, or they are the observed values of random vectors $Z_{1}, \dots , Z_{n}$ on whose values we condition before computing the joint distribution of ($Y_{1}, \dots , Y_{n}$) <span class="co">[</span><span class="ot">@degroot2012, p. 736</span><span class="co">]</span>.</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>Assumption 2</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Normality__. For $i = 1, \dots, n$, the conditional distribution of $Y_{i}$ given the vectors $z_{1}, \dots , z_{n}$ is a normal distribution <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>(Normality of the error term distribution <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>Assumption 3</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Linear mean__. There is a vector of parameters  $\beta = (\beta_{0}, \dots, \beta_{p - 1})$ such that the conditional mean of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ has the form</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>z_{i0} \beta_{0} + z_{i1} \beta_{1} + \cdots + z_{ip - 1} \beta_{p - 1}</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>for $i = 1, \dots, n$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>(Linearity of the phenomenon measured <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>Assumption 4</span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Common variance__. There is as parameter $\sigma^{2}$ such the conditional variance of $Y_{i}$ given the values $z_{1}, \dots , z_{n}$ is $\sigma^{2}$ for $i = 1, \dots\, n$.</span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>(Constant variance of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>Assumption 5</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} __Independence__. The random variables $Y_{1}, \dots , Y_{n}$ are independent given the observed $z_{1}, \dots , z_{n}$ <span class="co">[</span><span class="ot">@degroot2012, p. 737</span><span class="co">]</span>.</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>(Independence of the error terms <span class="co">[</span><span class="ot">@hair2019, p. 287</span><span class="co">]</span>)</span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setting up the environment</span></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(checkmate)</span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fBasics)</span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parsnip)</span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recipes)</span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rutils)</span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(workflows)</span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>test_outlier <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>    x, </span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"iqr"</span>, </span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>, </span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mult =</span> <span class="dv">3</span></span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(method, <span class="fu">c</span>(<span class="st">"iqr"</span>, <span class="st">"sd"</span>))</span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult)</span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(sd_mult)</span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"iqr"</span>) {</span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>    iqr <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">IQR</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>    min <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> (iqr_mult <span class="sc">*</span> iqr)</span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>    max <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (iqr_mult <span class="sc">*</span> iqr)</span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">"sd"</span>) {</span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>    min <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> (sd_mult <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>    max <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> (sd_mult <span class="sc">*</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">if_else</span>(x <span class="sc">&gt;=</span> min <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> max, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="at">missing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-164"><a href="#cb40-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-165"><a href="#cb40-165" aria-hidden="true" tabindex="-1"></a>remove_outliers <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-166"><a href="#cb40-166" aria-hidden="true" tabindex="-1"></a>    x, </span>
<span id="cb40-167"><a href="#cb40-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"iqr"</span>, </span>
<span id="cb40-168"><a href="#cb40-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>, </span>
<span id="cb40-169"><a href="#cb40-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mult =</span> <span class="dv">3</span></span>
<span id="cb40-170"><a href="#cb40-170" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-171"><a href="#cb40-171" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-172"><a href="#cb40-172" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(method, <span class="fu">c</span>(<span class="st">"iqr"</span>, <span class="st">"sd"</span>))</span>
<span id="cb40-173"><a href="#cb40-173" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb40-174"><a href="#cb40-174" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(sd_mult, <span class="at">lower =</span> <span class="dv">0</span>)</span>
<span id="cb40-175"><a href="#cb40-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-176"><a href="#cb40-176" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">|&gt;</span></span>
<span id="cb40-177"><a href="#cb40-177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">test_outlier</span>(</span>
<span id="cb40-178"><a href="#cb40-178" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> method, </span>
<span id="cb40-179"><a href="#cb40-179" aria-hidden="true" tabindex="-1"></a>      <span class="at">iqr_mult =</span> iqr_mult, </span>
<span id="cb40-180"><a href="#cb40-180" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_mult =</span> sd_mult</span>
<span id="cb40-181"><a href="#cb40-181" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb40-182"><a href="#cb40-182" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-183"><a href="#cb40-183" aria-hidden="true" tabindex="-1"></a>    magrittr<span class="sc">::</span><span class="fu">extract</span>(x, .)</span>
<span id="cb40-184"><a href="#cb40-184" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-185"><a href="#cb40-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-186"><a href="#cb40-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-189"><a href="#cb40-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-190"><a href="#cb40-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-191"><a href="#cb40-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-192"><a href="#cb40-192" aria-hidden="true" tabindex="-1"></a>list_as_tibble <span class="ot">&lt;-</span> <span class="cf">function</span>(list) {</span>
<span id="cb40-193"><a href="#cb40-193" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_list</span>(list)</span>
<span id="cb40-194"><a href="#cb40-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-195"><a href="#cb40-195" aria-hidden="true" tabindex="-1"></a>  list <span class="sc">|&gt;</span></span>
<span id="cb40-196"><a href="#cb40-196" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-197"><a href="#cb40-197" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb40-198"><a href="#cb40-198" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb40-199"><a href="#cb40-199" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>(),</span>
<span id="cb40-200"><a href="#cb40-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> as.character</span>
<span id="cb40-201"><a href="#cb40-201" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-202"><a href="#cb40-202" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb40-203"><a href="#cb40-203" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>())</span>
<span id="cb40-204"><a href="#cb40-204" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-205"><a href="#cb40-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-206"><a href="#cb40-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-209"><a href="#cb40-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-210"><a href="#cb40-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-211"><a href="#cb40-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-212"><a href="#cb40-212" aria-hidden="true" tabindex="-1"></a>stats_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-213"><a href="#cb40-213" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb40-214"><a href="#cb40-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-215"><a href="#cb40-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-216"><a href="#cb40-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-217"><a href="#cb40-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr_mult =</span> <span class="fl">1.5</span>,</span>
<span id="cb40-218"><a href="#cb40-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">as_list =</span> <span class="cn">FALSE</span></span>
<span id="cb40-219"><a href="#cb40-219" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-220"><a href="#cb40-220" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-221"><a href="#cb40-221" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-222"><a href="#cb40-222" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb40-223"><a href="#cb40-223" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(remove_outliers)</span>
<span id="cb40-224"><a href="#cb40-224" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb40-225"><a href="#cb40-225" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(as_list)</span>
<span id="cb40-226"><a href="#cb40-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-227"><a href="#cb40-227" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(remove_outliers)) {</span>
<span id="cb40-228"><a href="#cb40-228" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">remove_outliers</span>(<span class="at">method =</span> <span class="st">"iqr"</span>, <span class="at">iqr_mult =</span> iqr_mult)</span>
<span id="cb40-229"><a href="#cb40-229" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-230"><a href="#cb40-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-231"><a href="#cb40-231" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-232"><a href="#cb40-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">length</span>(x),</span>
<span id="cb40-233"><a href="#cb40-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_rm_na =</span> <span class="fu">length</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]),</span>
<span id="cb40-234"><a href="#cb40-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_na =</span> <span class="fu">length</span>(x[<span class="fu">is.na</span>(x)]),</span>
<span id="cb40-235"><a href="#cb40-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb40-236"><a href="#cb40-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> stats<span class="sc">::</span><span class="fu">var</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb40-237"><a href="#cb40-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> stats<span class="sc">::</span><span class="fu">sd</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb40-238"><a href="#cb40-238" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="dv">0</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb40-239"><a href="#cb40-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">q_1 =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.25</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb40-240"><a href="#cb40-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.5</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb40-241"><a href="#cb40-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">q_3 =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="fl">0.75</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb40-242"><a href="#cb40-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> rutils<span class="sc">:::</span><span class="fu">clear_names</span>(stats<span class="sc">::</span><span class="fu">quantile</span>(x, <span class="dv">1</span>, <span class="at">na.rm =</span> na_rm)),</span>
<span id="cb40-243"><a href="#cb40-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb40-244"><a href="#cb40-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">skewness =</span> moments<span class="sc">::</span><span class="fu">skewness</span>(x, <span class="at">na.rm =</span> na_rm),</span>
<span id="cb40-245"><a href="#cb40-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">kurtosis =</span> moments<span class="sc">::</span><span class="fu">kurtosis</span>(x, <span class="at">na.rm =</span> na_rm)</span>
<span id="cb40-246"><a href="#cb40-246" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-247"><a href="#cb40-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-248"><a href="#cb40-248" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(name)) out <span class="ot">&lt;-</span> <span class="fu">append</span>(out, <span class="fu">list</span>(<span class="at">name =</span> name), <span class="at">after =</span> <span class="dv">0</span>)</span>
<span id="cb40-249"><a href="#cb40-249" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-250"><a href="#cb40-250" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(as_list)) {</span>
<span id="cb40-251"><a href="#cb40-251" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb40-252"><a href="#cb40-252" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-253"><a href="#cb40-253" aria-hidden="true" tabindex="-1"></a>    out <span class="sc">|&gt;</span> <span class="fu">list_as_tibble</span>()</span>
<span id="cb40-254"><a href="#cb40-254" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-255"><a href="#cb40-255" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-256"><a href="#cb40-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-257"><a href="#cb40-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-260"><a href="#cb40-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-261"><a href="#cb40-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-262"><a href="#cb40-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-263"><a href="#cb40-263" aria-hidden="true" tabindex="-1"></a>plot_qq <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-264"><a href="#cb40-264" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb40-265"><a href="#cb40-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-266"><a href="#cb40-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-267"><a href="#cb40-267" aria-hidden="true" tabindex="-1"></a>    <span class="at">print =</span> <span class="cn">TRUE</span></span>
<span id="cb40-268"><a href="#cb40-268" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-269"><a href="#cb40-269" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-270"><a href="#cb40-270" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-271"><a href="#cb40-271" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb40-272"><a href="#cb40-272" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb40-273"><a href="#cb40-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-274"><a href="#cb40-274" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>()</span>
<span id="cb40-275"><a href="#cb40-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-276"><a href="#cb40-276" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span></span>
<span id="cb40-277"><a href="#cb40-277" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">y =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb40-278"><a href="#cb40-278" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">sample =</span> y)) <span class="sc">+</span></span>
<span id="cb40-279"><a href="#cb40-279" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb40-280"><a href="#cb40-280" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-281"><a href="#cb40-281" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb40-282"><a href="#cb40-282" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Theoretical quantiles (Std. normal)"</span>,</span>
<span id="cb40-283"><a href="#cb40-283" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Sample quantiles"</span></span>
<span id="cb40-284"><a href="#cb40-284" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb40-285"><a href="#cb40-285" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb40-286"><a href="#cb40-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-287"><a href="#cb40-287" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(plot)</span>
<span id="cb40-288"><a href="#cb40-288" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-289"><a href="#cb40-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb40-290"><a href="#cb40-290" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-291"><a href="#cb40-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-292"><a href="#cb40-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-295"><a href="#cb40-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-296"><a href="#cb40-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-297"><a href="#cb40-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-298"><a href="#cb40-298" aria-hidden="true" tabindex="-1"></a>plot_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-299"><a href="#cb40-299" aria-hidden="true" tabindex="-1"></a>    x,</span>
<span id="cb40-300"><a href="#cb40-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"x"</span>,</span>
<span id="cb40-301"><a href="#cb40-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">bins =</span> <span class="dv">30</span>,</span>
<span id="cb40-302"><a href="#cb40-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">"density"</span>,</span>
<span id="cb40-303"><a href="#cb40-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-304"><a href="#cb40-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_line =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-305"><a href="#cb40-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-306"><a href="#cb40-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">print =</span> <span class="cn">TRUE</span></span>
<span id="cb40-307"><a href="#cb40-307" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-308"><a href="#cb40-308" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-309"><a href="#cb40-309" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name)</span>
<span id="cb40-310"><a href="#cb40-310" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(bins, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb40-311"><a href="#cb40-311" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(stat, <span class="fu">c</span>(<span class="st">"count"</span>, <span class="st">"density"</span>))</span>
<span id="cb40-312"><a href="#cb40-312" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-313"><a href="#cb40-313" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(density_line)</span>
<span id="cb40-314"><a href="#cb40-314" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb40-315"><a href="#cb40-315" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb40-316"><a href="#cb40-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-317"><a href="#cb40-317" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>()</span>
<span id="cb40-318"><a href="#cb40-318" aria-hidden="true" tabindex="-1"></a>  y_lab <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(stat <span class="sc">==</span> <span class="st">"count"</span>, <span class="st">"Frequency"</span>, <span class="st">"Density"</span>)</span>
<span id="cb40-319"><a href="#cb40-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-320"><a href="#cb40-320" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span></span>
<span id="cb40-321"><a href="#cb40-321" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">y =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb40-322"><a href="#cb40-322" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> y)) <span class="sc">+</span></span>
<span id="cb40-323"><a href="#cb40-323" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_histogram</span>(</span>
<span id="cb40-324"><a href="#cb40-324" aria-hidden="true" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">y =</span> ggplot2<span class="sc">::</span><span class="fu">after_stat</span>(<span class="sc">!!</span><span class="fu">as.symbol</span>(stat))),</span>
<span id="cb40-325"><a href="#cb40-325" aria-hidden="true" tabindex="-1"></a>      <span class="at">bins =</span> <span class="dv">30</span>, </span>
<span id="cb40-326"><a href="#cb40-326" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"white"</span></span>
<span id="cb40-327"><a href="#cb40-327" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb40-328"><a href="#cb40-328" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> name, <span class="at">y =</span> y_lab) <span class="sc">+</span></span>
<span id="cb40-329"><a href="#cb40-329" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb40-330"><a href="#cb40-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-331"><a href="#cb40-331" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stat <span class="sc">==</span> <span class="st">"density"</span> <span class="sc">&amp;&amp;</span> <span class="fu">isTRUE</span>(density_line)) {</span>
<span id="cb40-332"><a href="#cb40-332" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span> plot <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>)</span>
<span id="cb40-333"><a href="#cb40-333" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-334"><a href="#cb40-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-335"><a href="#cb40-335" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(plot)</span>
<span id="cb40-336"><a href="#cb40-336" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-337"><a href="#cb40-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb40-338"><a href="#cb40-338" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-339"><a href="#cb40-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-340"><a href="#cb40-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-343"><a href="#cb40-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-344"><a href="#cb40-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-345"><a href="#cb40-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-346"><a href="#cb40-346" aria-hidden="true" tabindex="-1"></a>plot_ggally <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb40-347"><a href="#cb40-347" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb40-348"><a href="#cb40-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">names</span>(data),</span>
<span id="cb40-349"><a href="#cb40-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-350"><a href="#cb40-350" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis_labels =</span> <span class="st">"none"</span>,</span>
<span id="cb40-351"><a href="#cb40-351" aria-hidden="true" tabindex="-1"></a>    <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-352"><a href="#cb40-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">text_size =</span> <span class="cn">NULL</span></span>
<span id="cb40-353"><a href="#cb40-353" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb40-354"><a href="#cb40-354" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_tibble</span>(data)</span>
<span id="cb40-355"><a href="#cb40-355" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_character</span>(cols)</span>
<span id="cb40-356"><a href="#cb40-356" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_subset</span>(cols, <span class="fu">names</span>(data))</span>
<span id="cb40-357"><a href="#cb40-357" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_class</span>(mapping, <span class="st">"uneval"</span>, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-358"><a href="#cb40-358" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_choice</span>(axis_labels, <span class="fu">c</span>(<span class="st">"show"</span>, <span class="st">"internal"</span>, <span class="st">"none"</span>))</span>
<span id="cb40-359"><a href="#cb40-359" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(na_rm)</span>
<span id="cb40-360"><a href="#cb40-360" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-361"><a href="#cb40-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-362"><a href="#cb40-362" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span></span>
<span id="cb40-363"><a href="#cb40-363" aria-hidden="true" tabindex="-1"></a>    data<span class="sc">|&gt;</span></span>
<span id="cb40-364"><a href="#cb40-364" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">all_of</span>(cols))<span class="sc">|&gt;</span></span>
<span id="cb40-365"><a href="#cb40-365" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb40-366"><a href="#cb40-366" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb40-367"><a href="#cb40-367" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(hms<span class="sc">::</span>is_hms),</span>
<span id="cb40-368"><a href="#cb40-368" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">midday_trigger</span>(.x)</span>
<span id="cb40-369"><a href="#cb40-369" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb40-370"><a href="#cb40-370" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb40-371"><a href="#cb40-371" aria-hidden="true" tabindex="-1"></a>        <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(</span>
<span id="cb40-372"><a href="#cb40-372" aria-hidden="true" tabindex="-1"></a>          <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.character</span>(.x) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.factor</span>(.x) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.numeric</span>(.x)</span>
<span id="cb40-373"><a href="#cb40-373" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb40-374"><a href="#cb40-374" aria-hidden="true" tabindex="-1"></a>        <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(.x)</span>
<span id="cb40-375"><a href="#cb40-375" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-376"><a href="#cb40-376" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-377"><a href="#cb40-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-378"><a href="#cb40-378" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(na_rm)) out <span class="ot">&lt;-</span> out<span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>(dplyr<span class="sc">::</span><span class="fu">all_of</span>(cols))</span>
<span id="cb40-379"><a href="#cb40-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-380"><a href="#cb40-380" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(mapping)) {</span>
<span id="cb40-381"><a href="#cb40-381" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span></span>
<span id="cb40-382"><a href="#cb40-382" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">|&gt;</span></span>
<span id="cb40-383"><a href="#cb40-383" aria-hidden="true" tabindex="-1"></a>      GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb40-384"><a href="#cb40-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"smooth"</span>),</span>
<span id="cb40-385"><a href="#cb40-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisLabels =</span> axis_labels</span>
<span id="cb40-386"><a href="#cb40-386" aria-hidden="true" tabindex="-1"></a>      ) </span>
<span id="cb40-387"><a href="#cb40-387" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-388"><a href="#cb40-388" aria-hidden="true" tabindex="-1"></a>    plot <span class="ot">&lt;-</span></span>
<span id="cb40-389"><a href="#cb40-389" aria-hidden="true" tabindex="-1"></a>      out<span class="sc">|&gt;</span></span>
<span id="cb40-390"><a href="#cb40-390" aria-hidden="true" tabindex="-1"></a>      GGally<span class="sc">::</span><span class="fu">ggpairs</span>(</span>
<span id="cb40-391"><a href="#cb40-391" aria-hidden="true" tabindex="-1"></a>        <span class="at">mapping =</span> mapping,</span>
<span id="cb40-392"><a href="#cb40-392" aria-hidden="true" tabindex="-1"></a>        <span class="at">axisLabels =</span> axis_labels</span>
<span id="cb40-393"><a href="#cb40-393" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb40-394"><a href="#cb40-394" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(</span>
<span id="cb40-395"><a href="#cb40-395" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.25</span>,</span>
<span id="cb40-396"><a href="#cb40-396" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.75</span>,</span>
<span id="cb40-397"><a href="#cb40-397" aria-hidden="true" tabindex="-1"></a>        <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-398"><a href="#cb40-398" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"viridis"</span></span>
<span id="cb40-399"><a href="#cb40-399" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb40-400"><a href="#cb40-400" aria-hidden="true" tabindex="-1"></a>      viridis<span class="sc">::</span><span class="fu">scale_fill_viridis</span>(</span>
<span id="cb40-401"><a href="#cb40-401" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.25</span>,</span>
<span id="cb40-402"><a href="#cb40-402" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.75</span>,</span>
<span id="cb40-403"><a href="#cb40-403" aria-hidden="true" tabindex="-1"></a>        <span class="at">discrete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-404"><a href="#cb40-404" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"viridis"</span></span>
<span id="cb40-405"><a href="#cb40-405" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-406"><a href="#cb40-406" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-407"><a href="#cb40-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-408"><a href="#cb40-408" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> </span>
<span id="cb40-409"><a href="#cb40-409" aria-hidden="true" tabindex="-1"></a>    plot <span class="sc">+</span></span>
<span id="cb40-410"><a href="#cb40-410" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> text_size))</span>
<span id="cb40-411"><a href="#cb40-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-412"><a href="#cb40-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(plot)</span>
<span id="cb40-413"><a href="#cb40-413" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-414"><a href="#cb40-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(plot)</span>
<span id="cb40-415"><a href="#cb40-415" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-416"><a href="#cb40-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-417"><a href="#cb40-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-420"><a href="#cb40-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-421"><a href="#cb40-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-422"><a href="#cb40-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-423"><a href="#cb40-423" aria-hidden="true" tabindex="-1"></a>test_normality <span class="ot">&lt;-</span> <span class="cf">function</span>(x,</span>
<span id="cb40-424"><a href="#cb40-424" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">"x"</span>,</span>
<span id="cb40-425"><a href="#cb40-425" aria-hidden="true" tabindex="-1"></a>                           <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-426"><a href="#cb40-426" aria-hidden="true" tabindex="-1"></a>                           <span class="at">iqr_mult =</span> <span class="fl">1.5</span>,</span>
<span id="cb40-427"><a href="#cb40-427" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_transform =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-428"><a href="#cb40-428" aria-hidden="true" tabindex="-1"></a>                           <span class="at">density_line =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-429"><a href="#cb40-429" aria-hidden="true" tabindex="-1"></a>                           <span class="at">text_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-430"><a href="#cb40-430" aria-hidden="true" tabindex="-1"></a>                           <span class="at">print =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb40-431"><a href="#cb40-431" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-432"><a href="#cb40-432" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_string</span>(name)</span>
<span id="cb40-433"><a href="#cb40-433" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(remove_outliers)</span>
<span id="cb40-434"><a href="#cb40-434" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(iqr_mult, <span class="at">lower =</span> <span class="dv">1</span>)</span>
<span id="cb40-435"><a href="#cb40-435" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(log_transform)</span>
<span id="cb40-436"><a href="#cb40-436" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(density_line)</span>
<span id="cb40-437"><a href="#cb40-437" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(text_size, <span class="at">null.ok =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-438"><a href="#cb40-438" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(print)</span>
<span id="cb40-439"><a href="#cb40-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-440"><a href="#cb40-440" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb40-441"><a href="#cb40-441" aria-hidden="true" tabindex="-1"></a>  n_rm_na <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rutils<span class="sc">:::</span><span class="fu">drop_na</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb40-442"><a href="#cb40-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-443"><a href="#cb40-443" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(remove_outliers)) {</span>
<span id="cb40-444"><a href="#cb40-444" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">remove_outliers</span>(<span class="at">method =</span> <span class="st">"iqr"</span>, <span class="at">iqr_mult =</span> iqr_mult)</span>
<span id="cb40-445"><a href="#cb40-445" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-446"><a href="#cb40-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-447"><a href="#cb40-447" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(log_transform)) {</span>
<span id="cb40-448"><a href="#cb40-448" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span></span>
<span id="cb40-449"><a href="#cb40-449" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">|&gt;</span></span>
<span id="cb40-450"><a href="#cb40-450" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-451"><a href="#cb40-451" aria-hidden="true" tabindex="-1"></a>      <span class="fu">drop_inf</span>()</span>
<span id="cb40-452"><a href="#cb40-452" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-453"><a href="#cb40-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-454"><a href="#cb40-454" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">7</span>) {</span>
<span id="cb40-455"><a href="#cb40-455" aria-hidden="true" tabindex="-1"></a>    ad <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">ad.test</span>()</span>
<span id="cb40-456"><a href="#cb40-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-457"><a href="#cb40-457" aria-hidden="true" tabindex="-1"></a>    cvm <span class="ot">&lt;-</span></span>
<span id="cb40-458"><a href="#cb40-458" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">|&gt;</span></span>
<span id="cb40-459"><a href="#cb40-459" aria-hidden="true" tabindex="-1"></a>      nortest<span class="sc">::</span><span class="fu">cvm.test</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-460"><a href="#cb40-460" aria-hidden="true" tabindex="-1"></a>      rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb40-461"><a href="#cb40-461" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-462"><a href="#cb40-462" aria-hidden="true" tabindex="-1"></a>    ad <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-463"><a href="#cb40-463" aria-hidden="true" tabindex="-1"></a>    cmv <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-464"><a href="#cb40-464" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-465"><a href="#cb40-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-466"><a href="#cb40-466" aria-hidden="true" tabindex="-1"></a>  bonett <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> moments<span class="sc">::</span><span class="fu">bonett.test</span>()</span>
<span id="cb40-467"><a href="#cb40-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-468"><a href="#cb40-468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># See also `Rita::DPTest()` (just for Omnibus (K) tests).</span></span>
<span id="cb40-469"><a href="#cb40-469" aria-hidden="true" tabindex="-1"></a>  dagostino <span class="ot">&lt;-</span></span>
<span id="cb40-470"><a href="#cb40-470" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">|&gt;</span></span>
<span id="cb40-471"><a href="#cb40-471" aria-hidden="true" tabindex="-1"></a>    fBasics<span class="sc">::</span><span class="fu">dagoTest</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-472"><a href="#cb40-472" aria-hidden="true" tabindex="-1"></a>    rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb40-473"><a href="#cb40-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-474"><a href="#cb40-474" aria-hidden="true" tabindex="-1"></a>  jarque_bera <span class="ot">&lt;-</span></span>
<span id="cb40-475"><a href="#cb40-475" aria-hidden="true" tabindex="-1"></a>    rutils<span class="sc">:::</span><span class="fu">drop_na</span>(x) <span class="sc">|&gt;</span></span>
<span id="cb40-476"><a href="#cb40-476" aria-hidden="true" tabindex="-1"></a>    tseries<span class="sc">::</span><span class="fu">jarque.bera.test</span>()</span>
<span id="cb40-477"><a href="#cb40-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-478"><a href="#cb40-478" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">4</span>) {</span>
<span id="cb40-479"><a href="#cb40-479" aria-hidden="true" tabindex="-1"></a>    lillie_ks <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">lillie.test</span>()</span>
<span id="cb40-480"><a href="#cb40-480" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-481"><a href="#cb40-481" aria-hidden="true" tabindex="-1"></a>    lillie_ks <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-482"><a href="#cb40-482" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-483"><a href="#cb40-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-484"><a href="#cb40-484" aria-hidden="true" tabindex="-1"></a>  pearson <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">pearson.test</span>()</span>
<span id="cb40-485"><a href="#cb40-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-486"><a href="#cb40-486" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;&amp;</span> n_rm_na <span class="sc">&lt;=</span> <span class="dv">5000</span>) {</span>
<span id="cb40-487"><a href="#cb40-487" aria-hidden="true" tabindex="-1"></a>    sf <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nortest<span class="sc">::</span><span class="fu">sf.test</span>()</span>
<span id="cb40-488"><a href="#cb40-488" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-489"><a href="#cb40-489" aria-hidden="true" tabindex="-1"></a>    sf <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-490"><a href="#cb40-490" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-491"><a href="#cb40-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-492"><a href="#cb40-492" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_rm_na <span class="sc">&gt;=</span> <span class="dv">3</span> <span class="sc">&amp;&amp;</span> n_rm_na <span class="sc">&lt;=</span> <span class="dv">3000</span>) {</span>
<span id="cb40-493"><a href="#cb40-493" aria-hidden="true" tabindex="-1"></a>    shapiro <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> stats<span class="sc">::</span><span class="fu">shapiro.test</span>()</span>
<span id="cb40-494"><a href="#cb40-494" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-495"><a href="#cb40-495" aria-hidden="true" tabindex="-1"></a>    shapiro <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb40-496"><a href="#cb40-496" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-497"><a href="#cb40-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-498"><a href="#cb40-498" aria-hidden="true" tabindex="-1"></a>  qq_plot <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> <span class="fu">plot_qq</span>(<span class="at">text_size =</span> text_size, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-499"><a href="#cb40-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-500"><a href="#cb40-500" aria-hidden="true" tabindex="-1"></a>  hist_plot <span class="ot">&lt;-</span></span>
<span id="cb40-501"><a href="#cb40-501" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">|&gt;</span></span>
<span id="cb40-502"><a href="#cb40-502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_hist</span>(</span>
<span id="cb40-503"><a href="#cb40-503" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb40-504"><a href="#cb40-504" aria-hidden="true" tabindex="-1"></a>      <span class="at">text_size =</span> text_size,</span>
<span id="cb40-505"><a href="#cb40-505" aria-hidden="true" tabindex="-1"></a>      <span class="at">density_line =</span> density_line,</span>
<span id="cb40-506"><a href="#cb40-506" aria-hidden="true" tabindex="-1"></a>      <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb40-507"><a href="#cb40-507" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-508"><a href="#cb40-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-509"><a href="#cb40-509" aria-hidden="true" tabindex="-1"></a>  grid_plot <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(hist_plot, qq_plot, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb40-510"><a href="#cb40-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-511"><a href="#cb40-511" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-512"><a href="#cb40-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">stats =</span> <span class="fu">stats_sum</span>(</span>
<span id="cb40-513"><a href="#cb40-513" aria-hidden="true" tabindex="-1"></a>      x,</span>
<span id="cb40-514"><a href="#cb40-514" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb40-515"><a href="#cb40-515" aria-hidden="true" tabindex="-1"></a>      <span class="at">na_rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-516"><a href="#cb40-516" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove_outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-517"><a href="#cb40-517" aria-hidden="true" tabindex="-1"></a>      <span class="at">as_list =</span> <span class="cn">TRUE</span></span>
<span id="cb40-518"><a href="#cb40-518" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-519"><a href="#cb40-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">list</span>(</span>
<span id="cb40-520"><a href="#cb40-520" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> name,</span>
<span id="cb40-521"><a href="#cb40-521" aria-hidden="true" tabindex="-1"></a>      <span class="at">remove_outliers =</span> remove_outliers,</span>
<span id="cb40-522"><a href="#cb40-522" aria-hidden="true" tabindex="-1"></a>      <span class="at">log_transform =</span> log_transform,</span>
<span id="cb40-523"><a href="#cb40-523" aria-hidden="true" tabindex="-1"></a>      <span class="at">density_line =</span> density_line</span>
<span id="cb40-524"><a href="#cb40-524" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-525"><a href="#cb40-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-526"><a href="#cb40-526" aria-hidden="true" tabindex="-1"></a>    <span class="at">ad =</span> ad,</span>
<span id="cb40-527"><a href="#cb40-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">bonett =</span> bonett,</span>
<span id="cb40-528"><a href="#cb40-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">cvm =</span> cvm,</span>
<span id="cb40-529"><a href="#cb40-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">dagostino =</span> dagostino,</span>
<span id="cb40-530"><a href="#cb40-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">jarque_bera =</span> jarque_bera,</span>
<span id="cb40-531"><a href="#cb40-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">lillie_ks =</span> lillie_ks,</span>
<span id="cb40-532"><a href="#cb40-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">pearson =</span> pearson,</span>
<span id="cb40-533"><a href="#cb40-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf =</span> sf,</span>
<span id="cb40-534"><a href="#cb40-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">shapiro =</span> shapiro,</span>
<span id="cb40-535"><a href="#cb40-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-536"><a href="#cb40-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist_plot =</span> hist_plot,</span>
<span id="cb40-537"><a href="#cb40-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">qq_plot =</span> qq_plot,</span>
<span id="cb40-538"><a href="#cb40-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_plot =</span> grid_plot</span>
<span id="cb40-539"><a href="#cb40-539" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-540"><a href="#cb40-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-541"><a href="#cb40-541" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(print)) <span class="fu">print</span>(grid_plot)</span>
<span id="cb40-542"><a href="#cb40-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-543"><a href="#cb40-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(out)</span>
<span id="cb40-544"><a href="#cb40-544" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-545"><a href="#cb40-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-546"><a href="#cb40-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-549"><a href="#cb40-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-550"><a href="#cb40-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb40-551"><a href="#cb40-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-552"><a href="#cb40-552" aria-hidden="true" tabindex="-1"></a>normality_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">round =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">5</span>, ...) {</span>
<span id="cb40-553"><a href="#cb40-553" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_numeric</span>(x)</span>
<span id="cb40-554"><a href="#cb40-554" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_flag</span>(round)</span>
<span id="cb40-555"><a href="#cb40-555" aria-hidden="true" tabindex="-1"></a>  checkmate<span class="sc">::</span><span class="fu">assert_number</span>(digits)</span>
<span id="cb40-556"><a href="#cb40-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-557"><a href="#cb40-557" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">test_normality</span>(x, <span class="at">print =</span> <span class="cn">FALSE</span>, ...)</span>
<span id="cb40-558"><a href="#cb40-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-559"><a href="#cb40-559" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb40-560"><a href="#cb40-560" aria-hidden="true" tabindex="-1"></a>    <span class="at">test =</span> <span class="fu">c</span>(</span>
<span id="cb40-561"><a href="#cb40-561" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Anderson-Darling"</span>,</span>
<span id="cb40-562"><a href="#cb40-562" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Bonett-Seier"</span>,</span>
<span id="cb40-563"><a href="#cb40-563" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cramer-von Mises"</span>,</span>
<span id="cb40-564"><a href="#cb40-564" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Omnibus Test"</span>,</span>
<span id="cb40-565"><a href="#cb40-565" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Skewness Test"</span>,</span>
<span id="cb40-566"><a href="#cb40-566" aria-hidden="true" tabindex="-1"></a>      <span class="st">"D'Agostino Kurtosis Test"</span>,</span>
<span id="cb40-567"><a href="#cb40-567" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Jarque–Bera"</span>,</span>
<span id="cb40-568"><a href="#cb40-568" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Lilliefors (K-S)"</span>,</span>
<span id="cb40-569"><a href="#cb40-569" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Pearson chi-square"</span>,</span>
<span id="cb40-570"><a href="#cb40-570" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Shapiro-Francia"</span>,</span>
<span id="cb40-571"><a href="#cb40-571" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Shapiro-Wilk"</span></span>
<span id="cb40-572"><a href="#cb40-572" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-573"><a href="#cb40-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic_1 =</span> <span class="fu">c</span>(</span>
<span id="cb40-574"><a href="#cb40-574" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>ad<span class="sc">$</span>statistic,</span>
<span id="cb40-575"><a href="#cb40-575" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>statistic[<span class="dv">1</span>],</span>
<span id="cb40-576"><a href="#cb40-576" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>cvm<span class="sc">$</span>statistic,</span>
<span id="cb40-577"><a href="#cb40-577" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">1</span>],</span>
<span id="cb40-578"><a href="#cb40-578" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">2</span>],</span>
<span id="cb40-579"><a href="#cb40-579" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>statistic[<span class="dv">3</span>],</span>
<span id="cb40-580"><a href="#cb40-580" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>statistic,</span>
<span id="cb40-581"><a href="#cb40-581" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>lillie_ks<span class="sc">$</span>statistic,</span>
<span id="cb40-582"><a href="#cb40-582" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>pearson<span class="sc">$</span>statistic,</span>
<span id="cb40-583"><a href="#cb40-583" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>shapiro), <span class="cn">NA</span>, stats<span class="sc">$</span>shapiro<span class="sc">$</span>statistic),</span>
<span id="cb40-584"><a href="#cb40-584" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>sf), <span class="cn">NA</span>, stats<span class="sc">$</span>sf<span class="sc">$</span>statistic)</span>
<span id="cb40-585"><a href="#cb40-585" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-586"><a href="#cb40-586" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic_2 =</span> <span class="fu">c</span>(</span>
<span id="cb40-587"><a href="#cb40-587" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-588"><a href="#cb40-588" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>statistic[<span class="dv">2</span>],</span>
<span id="cb40-589"><a href="#cb40-589" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-590"><a href="#cb40-590" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-591"><a href="#cb40-591" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-592"><a href="#cb40-592" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-593"><a href="#cb40-593" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>parameter,</span>
<span id="cb40-594"><a href="#cb40-594" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-595"><a href="#cb40-595" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-596"><a href="#cb40-596" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>),</span>
<span id="cb40-597"><a href="#cb40-597" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="cn">NA</span>)</span>
<span id="cb40-598"><a href="#cb40-598" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-599"><a href="#cb40-599" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb40-600"><a href="#cb40-600" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>ad<span class="sc">$</span>p.value,</span>
<span id="cb40-601"><a href="#cb40-601" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>bonett<span class="sc">$</span>p.value,</span>
<span id="cb40-602"><a href="#cb40-602" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>cvm<span class="sc">$</span>p.value,</span>
<span id="cb40-603"><a href="#cb40-603" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">1</span>],</span>
<span id="cb40-604"><a href="#cb40-604" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">2</span>],</span>
<span id="cb40-605"><a href="#cb40-605" aria-hidden="true" tabindex="-1"></a>      <span class="fu">attr</span>(stats<span class="sc">$</span>dagostino, <span class="st">"test"</span>)<span class="sc">$</span>p.value[<span class="dv">3</span>],</span>
<span id="cb40-606"><a href="#cb40-606" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>jarque_bera<span class="sc">$</span>p.value,</span>
<span id="cb40-607"><a href="#cb40-607" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>lillie_ks<span class="sc">$</span>p.value,</span>
<span id="cb40-608"><a href="#cb40-608" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">$</span>pearson<span class="sc">$</span>p.value,</span>
<span id="cb40-609"><a href="#cb40-609" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>shapiro), <span class="cn">NA</span>, stats<span class="sc">$</span>shapiro<span class="sc">$</span>p.value),</span>
<span id="cb40-610"><a href="#cb40-610" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(<span class="fu">is.null</span>(stats<span class="sc">$</span>sf), <span class="cn">NA</span>, stats<span class="sc">$</span>sf<span class="sc">$</span>p.value)</span>
<span id="cb40-611"><a href="#cb40-611" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-612"><a href="#cb40-612" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-613"><a href="#cb40-613" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(test, p_value)</span>
<span id="cb40-614"><a href="#cb40-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-615"><a href="#cb40-615" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">isTRUE</span>(round)) {</span>
<span id="cb40-616"><a href="#cb40-616" aria-hidden="true" tabindex="-1"></a>    out <span class="sc">|&gt;</span></span>
<span id="cb40-617"><a href="#cb40-617" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb40-618"><a href="#cb40-618" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb40-619"><a href="#cb40-619" aria-hidden="true" tabindex="-1"></a>          <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">where</span>(is.numeric),</span>
<span id="cb40-620"><a href="#cb40-620" aria-hidden="true" tabindex="-1"></a>          <span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, digits)</span>
<span id="cb40-621"><a href="#cb40-621" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb40-622"><a href="#cb40-622" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb40-623"><a href="#cb40-623" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb40-624"><a href="#cb40-624" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-625"><a href="#cb40-625" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-626"><a href="#cb40-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-627"><a href="#cb40-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-628"><a href="#cb40-628" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preparing the data</span></span>
<span id="cb40-629"><a href="#cb40-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-632"><a href="#cb40-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-633"><a href="#cb40-633" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb40-634"><a href="#cb40-634" aria-hidden="true" tabindex="-1"></a>  palmerpenguins<span class="sc">::</span>penguins <span class="sc">|&gt;</span> </span>
<span id="cb40-635"><a href="#cb40-635" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bill_length_mm, bill_depth_mm, flipper_length_mm) <span class="sc">|&gt;</span></span>
<span id="cb40-636"><a href="#cb40-636" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb40-637"><a href="#cb40-637" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb40-638"><a href="#cb40-638" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>(),</span>
<span id="cb40-639"><a href="#cb40-639" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(<span class="fu">test_outlier</span>(.x, , <span class="at">iqr_mult =</span> <span class="dv">1</span>), <span class="cn">NA</span>, .x)</span>
<span id="cb40-640"><a href="#cb40-640" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-641"><a href="#cb40-641" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-642"><a href="#cb40-642" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span>
<span id="cb40-643"><a href="#cb40-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-644"><a href="#cb40-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-647"><a href="#cb40-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-648"><a href="#cb40-648" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb40-649"><a href="#cb40-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-650"><a href="#cb40-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-651"><a href="#cb40-651" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking variable distributions</span></span>
<span id="cb40-652"><a href="#cb40-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-653"><a href="#cb40-653" aria-hidden="true" tabindex="-1"></a>:::: {.panel-tabset}</span>
<span id="cb40-654"><a href="#cb40-654" aria-hidden="true" tabindex="-1"></a><span class="fu">### `bill_length_mm`</span></span>
<span id="cb40-655"><a href="#cb40-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-656"><a href="#cb40-656" aria-hidden="true" tabindex="-1"></a>::: {#tbl-bill_length_mm-stats}</span>
<span id="cb40-659"><a href="#cb40-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-660"><a href="#cb40-660" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb40-661"><a href="#cb40-661" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-662"><a href="#cb40-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"bill_length_mm"</span>)</span>
<span id="cb40-663"><a href="#cb40-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-664"><a href="#cb40-664" aria-hidden="true" tabindex="-1"></a>Statistics about the <span class="in">`bill_length_mm`</span> variable.</span>
<span id="cb40-665"><a href="#cb40-665" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-666"><a href="#cb40-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-667"><a href="#cb40-667" aria-hidden="true" tabindex="-1"></a>::: {#fig-bill_length_mm}</span>
<span id="cb40-670"><a href="#cb40-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-671"><a href="#cb40-671" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-672"><a href="#cb40-672" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-673"><a href="#cb40-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"bill_length_mm"</span>)</span>
<span id="cb40-674"><a href="#cb40-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-675"><a href="#cb40-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-676"><a href="#cb40-676" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`bill_length_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb40-677"><a href="#cb40-677" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-678"><a href="#cb40-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-679"><a href="#cb40-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### `bill_depth_mm`</span></span>
<span id="cb40-680"><a href="#cb40-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-681"><a href="#cb40-681" aria-hidden="true" tabindex="-1"></a>::: {#tbl-bill_depth_mm}</span>
<span id="cb40-684"><a href="#cb40-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-685"><a href="#cb40-685" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-686"><a href="#cb40-686" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-687"><a href="#cb40-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"bill_depth_mm"</span>)</span>
<span id="cb40-688"><a href="#cb40-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-689"><a href="#cb40-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-690"><a href="#cb40-690" aria-hidden="true" tabindex="-1"></a>Statistics about the <span class="in">`bill_depth_mm`</span> variable.</span>
<span id="cb40-691"><a href="#cb40-691" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-692"><a href="#cb40-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-693"><a href="#cb40-693" aria-hidden="true" tabindex="-1"></a>::: {#fig-bill_depth_mm}</span>
<span id="cb40-696"><a href="#cb40-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-697"><a href="#cb40-697" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-698"><a href="#cb40-698" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-699"><a href="#cb40-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"bill_depth_mm"</span>)</span>
<span id="cb40-700"><a href="#cb40-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-701"><a href="#cb40-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-702"><a href="#cb40-702" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`bill_depth_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb40-703"><a href="#cb40-703" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-704"><a href="#cb40-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-705"><a href="#cb40-705" aria-hidden="true" tabindex="-1"></a><span class="fu">### `flipper_length_mm`</span></span>
<span id="cb40-706"><a href="#cb40-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-707"><a href="#cb40-707" aria-hidden="true" tabindex="-1"></a>::: {#tbl-flipper_length_mm}</span>
<span id="cb40-710"><a href="#cb40-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-711"><a href="#cb40-711" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-712"><a href="#cb40-712" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(flipper_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-713"><a href="#cb40-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"flipper_length_mm"</span>)</span>
<span id="cb40-714"><a href="#cb40-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-715"><a href="#cb40-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-716"><a href="#cb40-716" aria-hidden="true" tabindex="-1"></a>Statistics about the <span class="in">`flipper_length_mm`</span> variable.</span>
<span id="cb40-717"><a href="#cb40-717" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-718"><a href="#cb40-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-719"><a href="#cb40-719" aria-hidden="true" tabindex="-1"></a>::: {#fig-flipper_length_mm}</span>
<span id="cb40-722"><a href="#cb40-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-723"><a href="#cb40-723" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-724"><a href="#cb40-724" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(flipper_length_mm) <span class="sc">|&gt;</span> </span>
<span id="cb40-725"><a href="#cb40-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>(<span class="at">name =</span> <span class="st">"flipper_length_mm"</span>)</span>
<span id="cb40-726"><a href="#cb40-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-727"><a href="#cb40-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-728"><a href="#cb40-728" aria-hidden="true" tabindex="-1"></a>Histogram of the <span class="in">`flipper_length_mm`</span> variable with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the variable and the theoretical quantiles of the normal distribution.</span>
<span id="cb40-729"><a href="#cb40-729" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-730"><a href="#cb40-730" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb40-731"><a href="#cb40-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-732"><a href="#cb40-732" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking correlations</span></span>
<span id="cb40-733"><a href="#cb40-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-734"><a href="#cb40-734" aria-hidden="true" tabindex="-1"></a>::: {#fig-correlation-matrix}</span>
<span id="cb40-737"><a href="#cb40-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-738"><a href="#cb40-738" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb40-739"><a href="#cb40-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_ggally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-740"><a href="#cb40-740" aria-hidden="true" tabindex="-1"></a>  rutils<span class="sc">:::</span><span class="fu">shush</span>()</span>
<span id="cb40-741"><a href="#cb40-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-742"><a href="#cb40-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-743"><a href="#cb40-743" aria-hidden="true" tabindex="-1"></a>Correlation matrix of data variables.</span>
<span id="cb40-744"><a href="#cb40-744" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-745"><a href="#cb40-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-746"><a href="#cb40-746" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting the model</span></span>
<span id="cb40-747"><a href="#cb40-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-750"><a href="#cb40-750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-751"><a href="#cb40-751" aria-hidden="true" tabindex="-1"></a>recipe <span class="ot">&lt;-</span> </span>
<span id="cb40-752"><a href="#cb40-752" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb40-753"><a href="#cb40-753" aria-hidden="true" tabindex="-1"></a>  recipes<span class="sc">::</span><span class="fu">recipe</span>(</span>
<span id="cb40-754"><a href="#cb40-754" aria-hidden="true" tabindex="-1"></a>    flipper_length_mm <span class="sc">~</span> bill_length_mm <span class="sc">+</span> bill_depth_mm, </span>
<span id="cb40-755"><a href="#cb40-755" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data</span>
<span id="cb40-756"><a href="#cb40-756" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-757"><a href="#cb40-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-758"><a href="#cb40-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-761"><a href="#cb40-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-762"><a href="#cb40-762" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> </span>
<span id="cb40-763"><a href="#cb40-763" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb40-764"><a href="#cb40-764" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_engine</span>(<span class="st">"lm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-765"><a href="#cb40-765" aria-hidden="true" tabindex="-1"></a>  parsnip<span class="sc">::</span><span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb40-766"><a href="#cb40-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-767"><a href="#cb40-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-770"><a href="#cb40-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-771"><a href="#cb40-771" aria-hidden="true" tabindex="-1"></a>workflow <span class="ot">&lt;-</span> </span>
<span id="cb40-772"><a href="#cb40-772" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-773"><a href="#cb40-773" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_recipe</span>(recipe) <span class="sc">|&gt;</span></span>
<span id="cb40-774"><a href="#cb40-774" aria-hidden="true" tabindex="-1"></a>  workflows<span class="sc">::</span><span class="fu">add_model</span>(model)</span>
<span id="cb40-775"><a href="#cb40-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-776"><a href="#cb40-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-779"><a href="#cb40-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-780"><a href="#cb40-780" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> workflow <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">fit</span>(data)</span>
<span id="cb40-781"><a href="#cb40-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-782"><a href="#cb40-782" aria-hidden="true" tabindex="-1"></a>fit</span>
<span id="cb40-783"><a href="#cb40-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-784"><a href="#cb40-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-787"><a href="#cb40-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-788"><a href="#cb40-788" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(fit)</span>
<span id="cb40-789"><a href="#cb40-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-790"><a href="#cb40-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-793"><a href="#cb40-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-794"><a href="#cb40-794" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(fit, data)</span>
<span id="cb40-795"><a href="#cb40-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-796"><a href="#cb40-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-799"><a href="#cb40-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-800"><a href="#cb40-800" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(fit) <span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> dplyr<span class="sc">::</span><span class="fu">everything</span>())</span>
<span id="cb40-801"><a href="#cb40-801" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-802"><a href="#cb40-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-805"><a href="#cb40-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-806"><a href="#cb40-806" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="ot">&lt;-</span> fit <span class="sc">|&gt;</span> parsnip<span class="sc">::</span><span class="fu">extract_fit_engine</span>()</span>
<span id="cb40-807"><a href="#cb40-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-808"><a href="#cb40-808" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb40-809"><a href="#cb40-809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-810"><a href="#cb40-810" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-fit}</span>
<span id="cb40-813"><a href="#cb40-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-814"><a href="#cb40-814" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb40-815"><a href="#cb40-815" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb40-816"><a href="#cb40-816" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(flipper_length_mm, .pred)) <span class="sc">+</span></span>
<span id="cb40-817"><a href="#cb40-817" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-818"><a href="#cb40-818" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-819"><a href="#cb40-819" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observed"</span>, <span class="at">y =</span> <span class="st">"Predicted"</span>) </span>
<span id="cb40-820"><a href="#cb40-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-821"><a href="#cb40-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-822"><a href="#cb40-822" aria-hidden="true" tabindex="-1"></a>Relation between fitted and predicted values.</span>
<span id="cb40-823"><a href="#cb40-823" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-824"><a href="#cb40-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-825"><a href="#cb40-825" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performing residual diagnostics</span></span>
<span id="cb40-826"><a href="#cb40-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-827"><a href="#cb40-827" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normality</span></span>
<span id="cb40-828"><a href="#cb40-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-829"><a href="#cb40-829" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-stats}</span>
<span id="cb40-832"><a href="#cb40-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-833"><a href="#cb40-833" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb40-834"><a href="#cb40-834" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-835"><a href="#cb40-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stats_sum</span>(<span class="at">name =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb40-836"><a href="#cb40-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-837"><a href="#cb40-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-838"><a href="#cb40-838" aria-hidden="true" tabindex="-1"></a>Statistics about the model residuals.</span>
<span id="cb40-839"><a href="#cb40-839" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-840"><a href="#cb40-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a>It is important to note that the Kolmogorov-Smirnov and Pearson chi-square test are here just for reference since many authors don't recommend using them when testing for normality <span class="co">[</span><span class="ot">@dagostino1990</span><span class="co">]</span>.</span>
<span id="cb40-842"><a href="#cb40-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-843"><a href="#cb40-843" aria-hidden="true" tabindex="-1"></a>Learn more about normality tests in @thode2002.</span>
<span id="cb40-844"><a href="#cb40-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-845"><a href="#cb40-845" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-846"><a href="#cb40-846" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb40-847"><a href="#cb40-847" aria-hidden="true" tabindex="-1"></a>\text{H}_{0}: \text{Normality} <span class="sc">\\</span></span>
<span id="cb40-848"><a href="#cb40-848" aria-hidden="true" tabindex="-1"></a>\text{H}_{a}: \text{Nonnormality}</span>
<span id="cb40-849"><a href="#cb40-849" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb40-850"><a href="#cb40-850" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb40-851"><a href="#cb40-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-852"><a href="#cb40-852" aria-hidden="true" tabindex="-1"></a>::: {#tbl-model-residual-diag-normality-tests}</span>
<span id="cb40-855"><a href="#cb40-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-856"><a href="#cb40-856" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb40-857"><a href="#cb40-857" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-858"><a href="#cb40-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">normality_sum</span>()</span>
<span id="cb40-859"><a href="#cb40-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-860"><a href="#cb40-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-861"><a href="#cb40-861" aria-hidden="true" tabindex="-1"></a>Normality tests about the model residuals</span>
<span id="cb40-862"><a href="#cb40-862" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-863"><a href="#cb40-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-864"><a href="#cb40-864" aria-hidden="true" tabindex="-1"></a>Correlation between observed residuals and expected residuals under normality.</span>
<span id="cb40-865"><a href="#cb40-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-868"><a href="#cb40-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-869"><a href="#cb40-869" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb40-870"><a href="#cb40-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-871"><a href="#cb40-871" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-872"><a href="#cb40-872" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(y <span class="sc">~</span> x, .) <span class="sc">|&gt;</span></span>
<span id="cb40-873"><a href="#cb40-873" aria-hidden="true" tabindex="-1"></a>    olsrr<span class="sc">::</span><span class="fu">ols_test_correlation</span>()</span>
<span id="cb40-874"><a href="#cb40-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-875"><a href="#cb40-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-878"><a href="#cb40-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-879"><a href="#cb40-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb40-880"><a href="#cb40-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-881"><a href="#cb40-881" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_correlation</span>()</span>
<span id="cb40-882"><a href="#cb40-882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-883"><a href="#cb40-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-884"><a href="#cb40-884" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-correlation}</span>
<span id="cb40-887"><a href="#cb40-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-888"><a href="#cb40-888" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span></span>
<span id="cb40-889"><a href="#cb40-889" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-890"><a href="#cb40-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_normality</span>()</span>
<span id="cb40-891"><a href="#cb40-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-892"><a href="#cb40-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-893"><a href="#cb40-893" aria-hidden="true" tabindex="-1"></a>Histogram of the model residuals with a kernel density estimate, along with a quantile-quantile (Q-Q) plot between the residuals and the theoretical quantiles of the normal distribution</span>
<span id="cb40-894"><a href="#cb40-894" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-895"><a href="#cb40-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-896"><a href="#cb40-896" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common variance</span></span>
<span id="cb40-897"><a href="#cb40-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-898"><a href="#cb40-898" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-fit-values-1}</span>
<span id="cb40-901"><a href="#cb40-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-902"><a href="#cb40-902" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb40-903"><a href="#cb40-903" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">augment</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb40-904"><a href="#cb40-904" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .resid)) <span class="sc">+</span></span>
<span id="cb40-905"><a href="#cb40-905" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-906"><a href="#cb40-906" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb40-907"><a href="#cb40-907" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb40-908"><a href="#cb40-908" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb40-909"><a href="#cb40-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-910"><a href="#cb40-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-911"><a href="#cb40-911" aria-hidden="true" tabindex="-1"></a>Relation between the fitted values of the restricted model and its residuals</span>
<span id="cb40-912"><a href="#cb40-912" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-913"><a href="#cb40-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-916"><a href="#cb40-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-917"><a href="#cb40-917" aria-hidden="true" tabindex="-1"></a>.resid_sd_error <span class="ot">&lt;-</span> </span>
<span id="cb40-918"><a href="#cb40-918" aria-hidden="true" tabindex="-1"></a>  fit_engine <span class="sc">|&gt;</span></span>
<span id="cb40-919"><a href="#cb40-919" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">deviance</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-920"><a href="#cb40-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-921"><a href="#cb40-921" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">/</span><span class="st">`</span>(stats<span class="sc">::</span><span class="fu">df.residual</span>(fit_engine))</span>
<span id="cb40-922"><a href="#cb40-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-923"><a href="#cb40-923" aria-hidden="true" tabindex="-1"></a>.resid_sd_error</span>
<span id="cb40-924"><a href="#cb40-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-925"><a href="#cb40-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-926"><a href="#cb40-926" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-fit-values-2}</span>
<span id="cb40-929"><a href="#cb40-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-930"><a href="#cb40-930" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span></span>
<span id="cb40-931"><a href="#cb40-931" aria-hidden="true" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">predict</span>(data) <span class="sc">|&gt;</span></span>
<span id="cb40-932"><a href="#cb40-932" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb40-933"><a href="#cb40-933" aria-hidden="true" tabindex="-1"></a>    <span class="at">.sd_resid =</span> </span>
<span id="cb40-934"><a href="#cb40-934" aria-hidden="true" tabindex="-1"></a>      stats<span class="sc">::</span><span class="fu">rstandard</span>(fit_engine) <span class="sc">|&gt;</span> </span>
<span id="cb40-935"><a href="#cb40-935" aria-hidden="true" tabindex="-1"></a>      <span class="fu">abs</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-936"><a href="#cb40-936" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb40-937"><a href="#cb40-937" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-938"><a href="#cb40-938" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(.pred, .sd_resid)) <span class="sc">+</span></span>
<span id="cb40-939"><a href="#cb40-939" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-940"><a href="#cb40-940" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb40-941"><a href="#cb40-941" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb40-942"><a href="#cb40-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Fitted values"</span>, </span>
<span id="cb40-943"><a href="#cb40-943" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sqrt{Standardized </span><span class="sc">\\</span><span class="st"> Residuals}$"</span>)</span>
<span id="cb40-944"><a href="#cb40-944" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-945"><a href="#cb40-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-946"><a href="#cb40-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-947"><a href="#cb40-947" aria-hidden="true" tabindex="-1"></a>Relation between the fitted values of the model and its standardized residuals</span>
<span id="cb40-948"><a href="#cb40-948" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-949"><a href="#cb40-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-952"><a href="#cb40-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-953"><a href="#cb40-953" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb40-954"><a href="#cb40-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-955"><a href="#cb40-955" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="dv">3</span>)</span>
<span id="cb40-956"><a href="#cb40-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-957"><a href="#cb40-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-960"><a href="#cb40-960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-961"><a href="#cb40-961" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_engine |&gt; lmtest::bptest()</span></span>
<span id="cb40-962"><a href="#cb40-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-963"><a href="#cb40-963" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_breusch_pagan</span>()</span>
<span id="cb40-964"><a href="#cb40-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-965"><a href="#cb40-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-968"><a href="#cb40-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-969"><a href="#cb40-969" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_test_score</span>()</span>
<span id="cb40-970"><a href="#cb40-970" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-971"><a href="#cb40-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-972"><a href="#cb40-972" aria-hidden="true" tabindex="-1"></a><span class="fu">### Independence</span></span>
<span id="cb40-973"><a href="#cb40-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-974"><a href="#cb40-974" aria-hidden="true" tabindex="-1"></a>Variance inflation factor (VIF)</span>
<span id="cb40-975"><a href="#cb40-975" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} "Indicator of the effect that the other independent variables have on the standard error of a regression coefficient. The variance inflation factor is directly related to the tolerance value ($\text{VIF}_{i} = 1/\text{TO}L$). Large VIF values also indicate a high degree of collinearity or multicollinearity among the independent variables" <span class="co">[</span><span class="ot">@hair2019, p. 265</span><span class="co">]</span>.</span>
<span id="cb40-976"><a href="#cb40-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-979"><a href="#cb40-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-980"><a href="#cb40-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb40-981"><a href="#cb40-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-982"><a href="#cb40-982" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_coll_diag</span>()</span>
<span id="cb40-983"><a href="#cb40-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-984"><a href="#cb40-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-985"><a href="#cb40-985" aria-hidden="true" tabindex="-1"></a><span class="fu">### Measures of influence</span></span>
<span id="cb40-986"><a href="#cb40-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-987"><a href="#cb40-987" aria-hidden="true" tabindex="-1"></a>Leverage points</span>
<span id="cb40-988"><a href="#cb40-988" aria-hidden="true" tabindex="-1"></a>: \hspace{20cm} "Type of _influential observation_ defined by one aspect of influence termed _leverage_. These observations are substantially different on one or more independent variables, so that they affect the estimation of one or more _regression coefficients_" <span class="co">[</span><span class="ot">@hair2019, p. 262</span><span class="co">]</span>.</span>
<span id="cb40-989"><a href="#cb40-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-990"><a href="#cb40-990" aria-hidden="true" tabindex="-1"></a>::: {#fig-model-residual-diag-leverage}</span>
<span id="cb40-993"><a href="#cb40-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-994"><a href="#cb40-994" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb40-995"><a href="#cb40-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-996"><a href="#cb40-996" aria-hidden="true" tabindex="-1"></a>fit_engine <span class="sc">|&gt;</span> olsrr<span class="sc">::</span><span class="fu">ols_plot_resid_lev</span>()</span>
<span id="cb40-997"><a href="#cb40-997" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb40-998"><a href="#cb40-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-999"><a href="#cb40-999" aria-hidden="true" tabindex="-1"></a>Relation between the model studentized residuals and their leverage/influence points.</span>
<span id="cb40-1000"><a href="#cb40-1000" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb40-1001"><a href="#cb40-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1002"><a href="#cb40-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">## References {.unnumbered}</span></span>
<span id="cb40-1003"><a href="#cb40-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-1004"><a href="#cb40-1004" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb40-1005"><a href="#cb40-1005" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/danielvartan/linear-model/edit/main/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/danielvartan/linear-model/issues/" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>